{"version":3,"sources":["../../src/components/block-chat/block-chat.ts","../../src/components/block-pdf/block-pdf.ts","../../node_modules/@angular/core/esm5 lazy","../../src lazy","../../src/pages/annotate/annotate.module.ts","../../src/pages/annotate/annotate.ts","../../src/models/models.ts","../../src/services/document.service.ts","../../src/directives/directives.module.ts","../../src/pages/email/email.module.ts","../../src/services/email.service.ts","../../src/pages/review/review.module.ts","../../src/pages/sign/sign.module.ts","../../src/pages/home/home.module.ts","../../src/pages/home/home.ts","../../src/services/global.service.ts","../../src/app/options.popover.page.ts","../../src/app/main.ts","../../src/app/app.module.ts","../../node_modules/moment/locale ^/.*$","../../util (ignored)","../../fs (ignored)","../../http (ignored)","../../https (ignored)","../../src/components/components.module.ts","../../src/components/block-steps/block-steps.ts","../../src/directives/absolute-drag/absolute-drag.ts","../../src/pages/email/email.ts","../../src/services/blockstack.service.ts","../../src/pages/review/review.ts","../../src/pages/sign/sign.ts","../../src/app/app.component.ts","../../src/services/coin.service.ts","../../src/services/cryptocompare.service.ts","../../src/services/slack.service.ts"],"names":[],"mappings":"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CnB;YACD,SAAS,EAAE;gBACT,2EAAS;gBACT,iFAAY;gBACZ,wFAAiB;gBACjB,4EAAW;gBACX,8FAAoB;gBACpB,8EAAY;gBACZ,gFAAa;gBACb,EAAC,OAAO,EAAE,2DAAY,EAAE,QAAQ,EAAE,wEAAiB,EAAC;gBACpD,oFAAe;gBACf,8EAAY;aACb;SACF,CAAC;OACW,SAAS,CAAG;IAAD,gBAAC;CAAA;AAAH;;;;;;;;ACtFtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA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","file":"main.js","sourcesContent":["import { Component, Input, OnDestroy, OnInit, AfterViewInit } from '@angular/core';\r\nimport { Observable } from 'rxjs/Rx';\r\nimport { DocumentService } from './../../services/document.service';\r\nimport { Document, Log, Message } from './../../models/models';\r\nimport { Events } from 'ionic-angular';\r\nimport { BlockStackService } from '../../services/blockstack.service';\r\nimport * as moment from 'moment';\r\ndeclare let $: any;\r\ndeclare let jslinq: any;\r\n\r\n/**\r\n * https://codepen.io/mehmetmert/pen/zbKpv\r\n */\r\n@Component({\r\n  selector: 'block-chat',\r\n  templateUrl: 'block-chat.html',\r\n})\r\nexport class BlockChatComponent implements OnDestroy, OnInit, AfterViewInit {\r\n\r\n  public doc: Document;\r\n  public message;\r\n  public subscription;\r\n  public chatSubscription;\r\n  public chatPolling;\r\n  public msgCount = 0;\r\n  public msgCountNew = 0;\r\n  firstLoad = true;\r\n\r\n  constructor(\r\n    public documentService: DocumentService,\r\n    public events: Events,\r\n    public blockstackService: BlockStackService\r\n  ) {\r\n\r\n  }\r\n\r\n  ngOnInit() {\r\n\r\n    this.firstLoad = true;\r\n    this.doc = new Document();\r\n\r\n    if (this.documentService.currentDoc) {\r\n      this.doc = this.documentService.currentDoc;\r\n      this.initChatPolling();\r\n    }\r\n    else {\r\n      this.subscription = this.events.subscribe('documentService:setCurrentDoc', async (currentDoc) => {\r\n        this.doc = currentDoc;\r\n        this.initChatPolling();\r\n      });\r\n    }\r\n\r\n    this.chatSubscription = this.events.subscribe('documentService:addedChat', async (msg) => {\r\n\r\n    });\r\n\r\n  }\r\n\r\n  ngAfterViewInit() {\r\n   \r\n  }\r\n\r\n\r\n  registerEmojiEvent(){\r\n    $(document).on(\"click\", \".emoji-picker\", function (e) {\r\n      e.stopPropagation();\r\n      $('.intercom-composer-emoji-popover').toggleClass(\"active\");\r\n    });\r\n    $(document).click(function (e) {\r\n      if ($(e.target).attr('class') != '.intercom-composer-emoji-popover' && $(e.target).parents(\".intercom-composer-emoji-popover\").length == 0) {\r\n        $(\".intercom-composer-emoji-popover\").removeClass(\"active\");\r\n      }\r\n    });\r\n    $(document).on(\"click\", \".intercom-emoji-picker-emoji\", function (e) {\r\n      if (e.target.className == \"intercom-emoji-picker-emoji\"){\r\n        let existing = $(\".emojiDiv\").val();\r\n        let emo = $(this).html();\r\n        $(\".emojiDiv\").val( existing + emo );\r\n      }\r\n    });\r\n    $('.intercom-composer-popover-input').on('input', function () {\r\n      var query = this.value;\r\n      if (query != \"\") {\r\n        $(\".intercom-emoji-picker-emoji:not([title*='\" + query + \"'])\").hide();\r\n      }\r\n      else {\r\n        $(\".intercom-emoji-picker-emoji\").show();\r\n      }\r\n    });\r\n  }\r\n\r\n  destroyEmojiEvents() {\r\n    \r\n    this.firstLoad = true;\r\n    $(document).off(\"click\", \".emoji-picker\");\r\n    $(document).off(\"click\");\r\n    $('.intercom-composer-popover-input').off('input');\r\n\r\n  }\r\n\r\n  initChatPolling() {\r\n    this.chatPolling = setInterval(() => {\r\n      setTimeout(() => { // hack?\r\n        this.getLogData(true);\r\n      }, 1000);\r\n    }, 3000);\r\n  }\r\n\r\n\r\n  ngOnDestroy() {\r\n    clearInterval(this.chatPolling);\r\n\r\n    if (this.subscription) {\r\n      this.subscription.unsubscribe();\r\n    }\r\n    if (this.chatSubscription) {\r\n      this.chatSubscription.unsubscribe();\r\n    }\r\n  }\r\n\r\n  async getLogData(isPoll) {\r\n\r\n    $(document).ready(async () => {\r\n\r\n      let logData: Log = await this.documentService.getLog(this.doc.guid);\r\n\r\n      $('.chat-head').html(this.doc.fileName);\r\n\r\n      let template = \"\";\r\n\r\n      if (!logData) {\r\n        $(\".loadSpin\").hide();\r\n        return;\r\n      }\r\n\r\n      this.msgCountNew = logData.messages.length;\r\n      if (this.msgCountNew > this.msgCount){\r\n        this.msgCount = this.msgCountNew;\r\n        let orderedMessages = jslinq(logData.messages).orderBy((el) => el.updatedAt).toList();\r\n\r\n        for (let item of orderedMessages) {\r\n  \r\n          let d = item.updatedAt;\r\n          let formatDate = moment(d).calendar(d);\r\n  \r\n          let uid = item.createdBy;\r\n          try {\r\n            uid = item.createdBy.replace('.id', '');\r\n          }\r\n          catch (e) { console.log('user does not have .id') };\r\n  \r\n          let uName = item.createdByName;\r\n          let uidClass = 'block-pic-' + uid;\r\n  \r\n          this.blockstackService.getPicUrl(uName).then((picUrl) => {\r\n            $('.' + uidClass).attr('src', picUrl);\r\n          });\r\n  \r\n          template = template + `  \r\n          <div class=\"chat-message clearfix\">\r\n          <img class=\"${uidClass}\" src=\"http://www.gravatar.com/avatar/?d=identicon\" alt=\"\" width=\"32\" height=\"32\">\r\n          <div class=\"chat-message-content clearfix\">\r\n            <span class=\"chat-time\">${formatDate}</span>\r\n            <h5>${item.email}</h5>\r\n            <p>${item.message}</p>\r\n          </div> \r\n          </div>\r\n          <hr style='margin-top:5px' />\r\n          `;\r\n        }\r\n\r\n        $('.log-history').html(template);\r\n        $('.chat-history').scrollTop($('.log-history').height());\r\n  \r\n      }\r\n\r\n      \r\n        $('.chat-history').scrollTop($('.log-history').height());\r\n        this.firstLoad = false;\r\n        $(\".loadSpin\").hide();\r\n      \r\n\r\n    });\r\n\r\n\r\n  }\r\n\r\n  minimize() {\r\n    $('.chat').slideToggle(300, 'swing');\r\n    $('.chat-message-counter').fadeToggle(300, 'swing');\r\n  }\r\n\r\n  async addMessage() {\r\n   \r\n    $(\".loadSpin\").show();\r\n    this.message = $('.emojiDiv').val();\r\n    await this.documentService.addMessage(this.doc.guid, this.message);\r\n    this.events.publish('documentService:addedChat', this.message);\r\n    this.message = null;\r\n    this.firstLoad = true;\r\n    $(\".loadSpin\").hide();\r\n    \r\n    $(\".intercom-composer-emoji-popover\").removeClass(\"active\");\r\n    // @todo optimize this with lazy load adding of new message\r\n    //await this.getLogData();\r\n  }\r\n\r\n  hasNoEvents(selector){\r\n    if($._data($(selector)[0]).events == null){\r\n      return true;\r\n    }\r\n    else{\r\n      return false;\r\n    }\r\n  }\r\n\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/block-chat/block-chat.ts","import { Component, ViewChild, Input, ChangeDetectionStrategy, ChangeDetectorRef, ViewContainerRef, AfterViewInit, OnDestroy, OnInit } from '@angular/core';\r\nimport { NavController, NavParams, IonicPage, Segment, LoadingController, AlertController, PopoverController } from 'ionic-angular';\r\nimport { CryptoCompareService } from '../../services/cryptocompare.service'\r\nimport { AbsoluteDragDirective } from '../../directives/absolute-drag/absolute-drag';\r\nimport { DocumentService } from '../../services/document.service';\r\nimport 'rxjs/add/operator/retry';\r\nimport 'rxjs/add/operator/timeout';\r\nimport 'rxjs/add/operator/delay';\r\nimport 'rxjs/add/operator/map';\r\nimport PDFJS from 'pdfjs-dist/build/pdf';\r\nimport pdfjsLib from 'pdfjs-dist/build/pdf';\r\nimport PDFAnnotate from 'pdf-annotate';\r\nimport annotations from './annotations';\r\nimport mockViewport from './mockViewport'\r\nimport { MyApp } from '../../app/app.component';\r\n//import { EmojiPopoverPage } from '../../app/emoji.popover.page';\r\ndeclare let CustomStyle: any;\r\ndeclare var $: any;\r\ndeclare var window: any;\r\ndeclare let TextLayerBuilder: any;\r\ndeclare let canvas: any;\r\ndeclare let scale: any;\r\ndeclare let rotation: any;\r\ndeclare var blockstack: any;\r\ndeclare let Event: any;\r\ndeclare let dragOn: any;\r\ndeclare let interact: any;\r\ndeclare let getQueryParam: any;\r\n\r\n\r\n/**\r\n * Generated class for the BlockPdfComponent component.\r\n *\r\n * See https://angular.io/api/core/Component for more info on Angular\r\n * Components.\r\n */\r\n@Component({\r\n  selector: 'block-pdf',\r\n  templateUrl: 'block-pdf.html',\r\n  //changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class BlockPdfComponent implements OnInit, AfterViewInit, OnDestroy {\r\n\r\n  //@ViewChild(AbsoluteDragDirective) vc: AbsoluteDragDirective;\r\n  svgDrawer;\r\n\r\n  @Input() showToolBar = 0;\r\n  @Input() locked = false;\r\n  @Input() showSignature: 0;\r\n  @Input() showSignHere: 0;\r\n  @Input() showButtons: 0;\r\n  @Input() marginTop = '130px';\r\n\r\n  public data: any;\r\n  public DOCUMENT_ID = \"blockusign/pdf1.txt\"; // @TODO not being used, delete in furture\r\n  public scale: any;\r\n  public rotation: any;\r\n  public UI = PDFAnnotate;\r\n  public page1: any;\r\n  public page2: any;\r\n  public tooltype: any;\r\n  public containerId: string = \"pageContainer1\";\r\n  public canvasId: string = \"canvas1\";\r\n  currPage = 1; //Pages are 1-based not 0-based\r\n  numPages = 0;\r\n  thePDF = null;  \r\n  pdfBuffer: any;\r\n  selectedElement = null;\r\n  prevElement = null;\r\n  currentX = 0;\r\n  currentY = 0;\r\n  yourName: string;\r\n  allowResize = false;\r\n  loading;\r\n\r\n  constructor(\r\n    public navCtrl: NavController,\r\n    public navParams: NavParams,\r\n    public documentService: DocumentService,\r\n    private changeDetector: ChangeDetectorRef,\r\n    private viewContainerRef: ViewContainerRef,\r\n    public loadingCtrl: LoadingController,\r\n    private alertCtrl: AlertController,\r\n    public popoverCtrl: PopoverController,\r\n  ) {\r\n    console.log('====> constructor');\r\n\r\n  }\r\n\r\n\r\n  ngOnInit() {\r\n    console.log('====> ngOnInit');\r\n    $(document).ready(() => {\r\n\r\n      this.loading = this.loadingCtrl.create({\r\n        content: 'Please wait...'\r\n      });\r\n      this.loading.present();\r\n\r\n      this.init();\r\n    });\r\n\r\n  }\r\n\r\n  ngAfterViewInit(){\r\n    \r\n  }\r\n\r\n  registerEmojiEvent(){\r\n\r\n    $(document).ready( () =>{\r\n      \r\n      $(document).on(\"click\", \".emoji-picker2\", function (e) {\r\n        e.stopPropagation();\r\n        $('.intercom-composer-emoji-popover2').toggleClass(\"active\");\r\n      });\r\n  \r\n      $(document).click(function (e) {\r\n        if ($(e.target).attr('class') != '.intercom-composer-emoji-popover2' && $(e.target).parents(\".intercom-composer-emoji-popover2\").length == 0) {\r\n          $(\".intercom-composer-emoji-popover2\").removeClass(\"active\");\r\n        }\r\n      });\r\n  \r\n      $(document).on(\"click\", \".intercom-emoji-picker-emoji\", function (e) {\r\n        if (e.target.className == \"intercom-emoji-picker-emoji p2\"){\r\n          let existing = $(\".emojiDiv2\").html();\r\n          let emo = $(this).html();\r\n          $(\".emojiDiv2\").html( existing + emo );\r\n        }\r\n      });\r\n  \r\n      $('.intercom-composer-popover-input2').on('input', function () {\r\n        var query = this.value;\r\n        if (query != \"\") {\r\n          $(\".intercom-emoji-picker-emoji:not([title*='\" + query + \"'])\").hide();\r\n        }\r\n        else {\r\n          $(\".intercom-emoji-picker-emoji\").show();\r\n        }\r\n      });\r\n\r\n    });\r\n   \r\n  }\r\n\r\n  destroyEmojiEvents(){\r\n    $(document).off(\"click\", \".emoji-picker2\");\r\n    $(document).off(\"click\");\r\n    $('.intercom-composer-popover-input2').off('input');\r\n  }\r\n\r\n\r\n  ngOnDestroy() {\r\n    console.log(\"====> ngOnDestroy\");\r\n   \r\n  }\r\n\r\n  init() {\r\n    \r\n\r\n    this.svgDrawer = dragOn(document.querySelector(\".dropzone\"), {\r\n      listenTo: '.draggable'\r\n    });\r\n\r\n    let docData = getQueryParam('docData');\r\n    if (docData) {\r\n      this.loading.dismiss();\r\n      return;\r\n    }\r\n\r\n    if (this.navParams.get(\"guid\") && !this.documentService.currentDoc) {\r\n      let guid = this.navParams.get(\"guid\");\r\n      this.documentService.getDocumentsIndex(true).then((data) => {\r\n        this.documentService.documentsList = data;\r\n        this.documentService.setCurrentDoc(guid);\r\n        this.getFile();\r\n        // @todo in side menu highlight selected doc\r\n      });\r\n    }\r\n    else if (this.documentService.currentDoc.guid) {\r\n      this.documentService.setCurrentDoc(this.documentService.currentDoc.guid);\r\n      this.getFile();\r\n    }\r\n    else {\r\n      let guid = this.navParams.get(\"guid\");\r\n      this.documentService.setCurrentDoc(guid);\r\n      this.getFile();\r\n    }\r\n\r\n    this.yourName = blockstack.loadUserData().profile.name;\r\n\r\n    if (this.yourName == null || this.yourName == \"\" || this.yourName == undefined){\r\n      this.yourName = \"[Edit Name]\"\r\n    }\r\n\r\n  }\r\n\r\n\r\n  async getFile() {\r\n\r\n    let data = await this.documentService.getDocument(this.documentService.currentDoc.guid + \".pdf\", this.documentService.currentDoc.documentKey);\r\n    this.pdfBuffer = data;\r\n\r\n    let pdfData = new Uint8Array(this.pdfBuffer);\r\n\r\n    this.loadPdf(pdfData); // loads the pdf to the screen with the text layers\r\n\r\n  }\r\n\r\n  back() {\r\n    \r\n    this.navCtrl.push(\"HomePage\");\r\n  }\r\n\r\n  next() {\r\n    this.navCtrl.push(\"EmailPage\", {\r\n      guid: this.documentService.currentDoc.guid\r\n    });\r\n  }\r\n\r\n  clear() {\r\n    this.svgDrawer.cleanHTML();\r\n    this.svgDrawer.cleanDrawArea();\r\n    this.svgDrawer.updateMetrics();\r\n    localStorage.removeItem('svg');\r\n  }\r\n\r\n  loadPdf(pdfData) {\r\n\r\n    let loadingTask = pdfjsLib.getDocument({ data: pdfData });\r\n\r\n    loadingTask.promise.then((pdf) => {\r\n\r\n      this.numPages = pdf.numPages;\r\n      this.thePDF = pdf;\r\n      \r\n      let viewer = document.getElementById('canvasWrapper');\r\n      let page;\r\n      for (page = 1; page <= pdf.numPages; page++) {\r\n        let canvas = document.createElement(\"canvas\");\r\n        viewer.appendChild(canvas);\r\n        this.renderPage(page, canvas);\r\n      }\r\n\r\n      this.loadSvg(1);\r\n\r\n      this.loading.dismiss();\r\n\r\n    }, (reason) => {\r\n\r\n      // PDF loading error\r\n      console.error(reason);\r\n\r\n    });\r\n\r\n  }\r\n\r\n\r\n  renderPage(pageNumber, canvas) {\r\n    this.thePDF.getPage(pageNumber).then(function (page) {\r\n      let viewport = page.getViewport(1);\r\n      canvas.height = viewport.height;\r\n      canvas.width = viewport.width;\r\n     \r\n      // Render PDF page into canvas context\r\n      let renderContext = {\r\n        canvasContext: canvas.getContext('2d'),\r\n        viewport: viewport\r\n      };\r\n\r\n      let renderTask = page.render(renderContext).then(() => {\r\n\r\n          // Get text-fragments\r\n          return page.getTextContent();\r\n        }).then((textContent) => {\r\n          // Create div which will hold text-fragments\r\n          let textLayerDiv = document.createElement(\"div\");\r\n\r\n          // Set it's class to textLayer which have required CSS styles\r\n          textLayerDiv.setAttribute(\"class\", \"textLayer\");\r\n\r\n          // Append newly created div in `div#page-#{pdf_page_number}`\r\n          //let div = document.getElementById(`${this.containerId}`);\r\n          let div = document.getElementById(`canvasWrapper`);\r\n          div.appendChild(textLayerDiv);\r\n\r\n\r\n\r\n          //Create new instance of TextLayerBuilder class\r\n          let textLayer = new TextLayerBuilder({\r\n            textLayerDiv: textLayerDiv,\r\n            pageIndex: page.pageIndex,\r\n            viewport: viewport\r\n          });\r\n\r\n          // Set text-fragments\r\n          textLayer.setTextContent(textContent);\r\n\r\n          // Render text-fragments\r\n          textLayer.render();\r\n\r\n        });\r\n\r\n    });\r\n  }\r\n\r\n  handleClearClick(e) {\r\n\r\n    if (confirm('Are you sure you want to throw your work away?')) {\r\n      //localStorage.removeItem(`${this.DOCUMENT_ID}/annotations`);\r\n      this.page1.innerHTML = '';\r\n    }\r\n\r\n  }\r\n\r\n  handleDragStart(e) {\r\n    //log(\"handleDragStart\");\r\n    e.style.opacity = '0.4'; // this ==> e.target is the source node.\r\n  };\r\n\r\n  // set the overlay dimensionss\r\n  overLay(page: any) {\r\n\r\n    let h = this.numPages * 792;\r\n\r\n    $(\"#svg-dropzone\").css(\"width\", \"612\");\r\n    $(\"#svg-dropzone\").css(\"height\", h);\r\n    $(\"#svg-dropzone\").attr(\"width\", \"612\");\r\n    $(\"#svg-dropzone\").attr(\"height\", h);\r\n    $(\"#svg-dropzone\").attr(\"viewBox\", \"0 0 612 \" + h);\r\n  }\r\n\r\n  async saveSvg() {\r\n   \r\n    let svg = \"\";\r\n    $(\".dragOn-drawArea\").each(function () {\r\n      let el = $(this);\r\n      if (el.html() !== \"\") {\r\n        svg = svg + el.html();\r\n      }\r\n    });\r\n\r\n    \r\n    await this.documentService.saveAnnotations(this.documentService.currentDoc.guid, svg);\r\n\r\n    await this.documentService.addMessage(this.documentService.currentDoc.guid, 'Updated annotation');\r\n\r\n  }\r\n\r\n  async loadSvg(page: any) {\r\n  \r\n    // overlay\r\n    this.overLay(page);\r\n\r\n    let json = await this.documentService.getAnnotations(this.documentService.currentDoc.guid);\r\n    let innerHtml = null;\r\n    if (json) {\r\n      innerHtml = json.annotations;\r\n    }\r\n\r\n    if (innerHtml) {\r\n      this.svgDrawer.addHTML(innerHtml, this.locked);\r\n    }\r\n\r\n  }\r\n\r\n  public editSignature(){\r\n    \r\n    let sig;\r\n    let alert = this.alertCtrl.create({\r\n      title: 'Please enter a new Signature',\r\n      message: '',\r\n      enableBackdropDismiss: false,\r\n      inputs: [\r\n        {\r\n          name: 'sig',\r\n          placeholder: 'signature',\r\n          value: sig\r\n        }\r\n      ],\r\n      buttons: [\r\n        {\r\n          text: 'Cancel',\r\n          role: 'cancel',\r\n          handler: data => {\r\n            console.log('Cancel clicked');\r\n          }\r\n        },\r\n        {\r\n          text: 'Ok',\r\n          handler: data => {\r\n            this.yourName = data.sig;\r\n\r\n            if (this.yourName == null || this.yourName == \"\" || this.yourName == undefined){\r\n              this.yourName = \"[Edit Name]\"\r\n            }\r\n\r\n          }\r\n        }\r\n      ]\r\n    });\r\n    alert.present();\r\n  \r\n  }\r\n\r\n  presentPopover(myEvent) {\r\n    // let popover = this.popoverCtrl.create(EmojiPopoverPage, {  });\r\n    // popover.present({\r\n    //   ev: myEvent\r\n    // });\r\n  }\r\n\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/block-pdf/block-pdf.ts","function webpackEmptyAsyncContext(req) {\n\t// Here Promise.resolve().then() is used instead of new Promise() to prevent\n\t// uncatched exception popping up in devtools\n\treturn Promise.resolve().then(function() {\n\t\tthrow new Error(\"Cannot find module '\" + req + \"'.\");\n\t});\n}\nwebpackEmptyAsyncContext.keys = function() { return []; };\nwebpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;\nmodule.exports = webpackEmptyAsyncContext;\nwebpackEmptyAsyncContext.id = 199;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/@angular/core/esm5 lazy\n// module id = 199\n// module chunks = 1","var map = {\n\t\"../pages/annotate/annotate.module\": [\n\t\t245\n\t],\n\t\"../pages/email/email.module\": [\n\t\t393\n\t],\n\t\"../pages/home/home.module\": [\n\t\t484\n\t],\n\t\"../pages/review/review.module\": [\n\t\t482\n\t],\n\t\"../pages/sign/sign.module\": [\n\t\t483\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tvar ids = map[req];\n\tif(!ids)\n\t\treturn Promise.reject(new Error(\"Cannot find module '\" + req + \"'.\"));\n\treturn Promise.all(ids.slice(1).map(__webpack_require__.e)).then(function() {\n\t\treturn __webpack_require__(ids[0]);\n\t});\n};\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 244;\nmodule.exports = webpackAsyncContext;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src lazy\n// module id = 244\n// module chunks = 1","import { IonicPageModule } from \"ionic-angular\";\r\nimport { AnnotatePage } from \"./annotate\";\r\nimport { NgModule, CUSTOM_ELEMENTS_SCHEMA } from \"@angular/core\";\r\n//import { AbsoluteDragDirective } from '../../directives/absolute-drag/absolute-drag';\r\nimport { BlockStepsComponentModule } from '../../components/components.module';\r\n\r\n@NgModule({\r\n    declarations: [\r\n        AnnotatePage,\r\n        \r\n        //AbsoluteDragDirective\r\n    ],\r\n    imports: [\r\n      IonicPageModule.forChild(AnnotatePage),\r\n      BlockStepsComponentModule\r\n    ],\r\n    entryComponents: [\r\n        AnnotatePage\r\n    ],\r\n    schemas: [ CUSTOM_ELEMENTS_SCHEMA ]\r\n  })\r\n  export class AnnotatePageModule {}\n\n\n// WEBPACK FOOTER //\n// ./src/pages/annotate/annotate.module.ts","import { Component, ViewChild } from '@angular/core';\r\nimport { NavController, NavParams, IonicPage, Segment, Events } from 'ionic-angular';\r\nimport { DocumentService } from '../../services/document.service';\r\nimport { BlockChatComponent } from './../../components/block-chat/block-chat';\r\nimport { BlockPdfComponent } from './../../components/block-pdf/block-pdf';\r\nimport 'rxjs/add/operator/retry';\r\nimport 'rxjs/add/operator/timeout';\r\nimport 'rxjs/add/operator/delay';\r\nimport 'rxjs/add/operator/map';\r\n\r\ndeclare var $: any;\r\ndeclare var window: any;\r\ndeclare var blockstack: any;\r\n\r\n/// https://www.sitepoint.com/custom-pdf-rendering/\r\n@IonicPage({\r\n  name: 'AnnotatePage',\r\n  segment: 'annotate/:guid',\r\n  defaultHistory: ['HomePage']\r\n})\r\n@Component({\r\n  selector: 'page-annotate',\r\n  templateUrl: 'annotate.html',\r\n  styles: ['annotate.scss']\r\n})\r\nexport class AnnotatePage {\r\n\r\n  @ViewChild(\"blockChat\") blockChat: BlockChatComponent;\r\n  @ViewChild(\"blockPdf\") blockPdf: BlockPdfComponent;\r\n\r\n  constructor(\r\n    public navCtrl: NavController, \r\n    public navParams: NavParams, \r\n    public documentService: DocumentService,\r\n    public events: Events\r\n  ) {\r\n    \r\n  }\r\n\r\n  \r\n  ionViewDidEnter(){\r\n    this.blockPdf.registerEmojiEvent();\r\n    this.blockChat.registerEmojiEvent();\r\n  }\r\n\r\n  ionViewWillLeave() {\r\n    this.blockChat.destroyEmojiEvents();\r\n    this.blockChat.firstLoad = true;\r\n    this.blockChat.ngOnDestroy();\r\n    this.blockPdf.destroyEmojiEvents();\r\n  }\r\n\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/annotate/annotate.ts","export class Document{\r\n    public fileName: string;\r\n    public documentKey: string; // the key to decrypt the doc\r\n    public code: string; // the code to allow a map to be created between the docuemnt guid an an array of replicated storage bucket locations to be stored in the global.map.json on the blockusign1 global storage bucket\r\n    public guid: any;\r\n    public createdAt: Date; \r\n    public updatedAt: Date; \r\n    public owner: Array<string>; // [\"nicktee.id\"] \r\n    public signer: Array<string>; // [\"nicktee.id || emailAddress\"] //  for now just 1 signer, in the future allow users without a blockstack id to sign, there name has no .id in it like [\"Alice Smith\"]\r\n    public reviewer: Array<string>; // [\"auditor.id\"] owners and signers are automatically reviewers\r\n    public hasAnnotations: boolean;\r\n    public step: string; // Annotate, Sign, Final\r\n    public isCompleted: boolean;\r\n    public annotationsRequired: Array<any>; // [ {\"Sign\": \"nicktee.id\"}, { Sign: \"blockusign1.id\" } ]\r\n    \r\n    public pathAnnotatedDoc: string; // fully qualified gaia path to the Annotated doc , this is usually in the owners storage bucket\r\n    //public pathSignedDoc: string; // fully qualified gaia path to the Signed doc, this is usually in the signers bucket\r\n    public paths: Array<NameStorageMapping>;\r\n\r\n    constructor() {\r\n        this.guid = (<any>window).guid();\r\n        this.createdAt = (<any>Date).now();\r\n        this.updatedAt = (<any>Date).now();\r\n        this.hasAnnotations = false;\r\n        this.step = \"Annotate\";\r\n        this.isCompleted = false\r\n    }\r\n}\r\n\r\nexport class Log {\r\n    public guid: any;\r\n    public createdAt: Date; \r\n    public updatedAt: Date; \r\n    public messages: Array<Message>;\r\n\r\n    constructor(){\r\n        this.guid = (<any>window).guid();\r\n        this.createdAt = (<any>Date).now();\r\n        this.updatedAt = (<any>Date).now();\r\n    }\r\n\r\n}\r\n\r\nexport class Message {\r\n    public guid: any;\r\n    public createdAt: Date; \r\n    public updatedAt: Date; \r\n    public message: string;\r\n    public createdBy: string;\r\n    public createdByName: string;\r\n    public email: string;\r\n\r\n    constructor(){\r\n        this.guid = (<any>window).guid();\r\n        this.createdAt = (<any>Date).now();\r\n        this.updatedAt = (<any>Date).now();\r\n    }\r\n\r\n}\r\n\r\n// This is an svg representing the annotations\r\nexport class Annotation{\r\n    public annotations: string;\r\n    constructor(){\r\n    \r\n    }\r\n}\r\n\r\nexport class DocStorageMaps{\r\n    public storagePaths: Array<string>;\r\n}\r\n\r\n// An array of annotation types, so far just signatures, maybe down the line support Number. OpenText etc...\r\nexport class AnnotationTypes{\r\n    constructor(){\r\n        return [\"Sign\"];\r\n    }\r\n}\r\n\r\nexport class NameStorageMapping {\r\n    public name?: string; // @todo required, but there is a potential for dups if two people choose the same name, also could fail if they edit user name. small tradoff tho for user usability, until the blockstack registrar is created\r\n    public userId?: string; // @todo optional, to allow for non registerd users without ID's\r\n    public email?: string; // optional, for users without user id's\r\n    public appPublicKey?: string; // optional, the public key for the user for the app via blockstack\r\n    public pathToStorage: string;\r\n}\r\n\r\n// // Index of documents for searching\r\n// // blockusign/documents.index.json\r\n// [\r\n//     {\r\n//         \"guid\": \"guid\",\r\n//         \"fileName\": \"blockusign/nicktee.id/one.pdf\", \r\n//         \"createdAt\": \"\", \r\n//         \"updatedAt\": \"\", \r\n//         \"owner\": [\"nicktee.id\", \"\"], \r\n//         \"signer\": [\"nicktee.id\"], \r\n//         \"hasAnnotations\": true,\r\n//         \"step\": 5,\r\n//         \"isCompleted\": true\r\n//     },\r\n//     {\r\n//         \"guid\": \"guid\",\r\n//         \"fileName\": \"blockusign/nicktee.id/two.pdf\", \r\n//         \"createdAt\": \"\", \r\n//         \"updatedAt\": \"\", \r\n//         \"owner\": [\"nicktee.id\", \"\"], \r\n//         \"signer\": [\"nicktee.id\"], \r\n//         \"hasAnnotations\": true,\r\n//         \"step\": 1,\r\n//         \"isCompleted\": false\r\n//     }\r\n// ]\r\n\r\n// // documents\r\n// // blockusign/guid.pdf\r\n\r\n// // documents metadata and annotations\r\n// // blockusign/guid.json\r\n// {\r\n//     annotations: \"<img></img><img></img>\"\r\n// }\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/models/models.ts","import { Injectable } from '@angular/core';\r\nimport { Document, Log, Message, DocStorageMaps } from './../models/models';\r\nimport 'rxjs/add/operator/toPromise';\r\nimport { Http, Response } from '@angular/http';\r\nimport { Observable } from 'rxjs/Observable';\r\nimport 'rxjs/add/operator/map';\r\nimport 'rxjs/add/operator/catch';\r\nimport { AnonymousSubject } from 'rxjs/Subject';\r\nimport { Events } from 'ionic-angular';\r\nimport * as moment from 'moment';\r\nimport * as Automerge from 'automerge/dist/automerge.js';\r\nimport { BlockStackService } from './blockstack.service';\r\nimport { State } from './../models/state';\r\nimport { of } from 'rxjs/observable/of';\r\ndeclare let jslinq: any;\r\ndeclare let blockstack: any;\r\ndeclare let sjcl: any;\r\ndeclare let $: any;\r\n\r\n\r\n@Injectable()\r\nexport class DocumentService {\r\n\r\n  private indexFileName = \"blockusign/documents.index.json\";\r\n  public documentsList: Array<Document>;\r\n  public documentsListFiltered: Array<Document>;\r\n  public docBuffer: any;\r\n  public currentDoc: Document;\r\n  public currentDocAnnotationsDoc;\r\n  public currentDocAnnotations;\r\n  public logDoc: any;\r\n  public log: Log;\r\n  public docStorageMaps: DocStorageMaps;\r\n  public urlBlockusignGlobalStore = \"https://gaia.blockstack.org/hub/1PoZGGAuQ4yPj72TrXbG4pKbgB9tvCUqQ1/blockusign\";\r\n  public urlBlockusign =  \"https://blockusign.co\"; //\"https://blockusign.co\"; // \"http://localhost:52657\";\r\n \r\n\r\n  constructor(\r\n    public events: Events, \r\n    private http: Http,\r\n    private blockStackService: BlockStackService\r\n  ) {\r\n    console.log('Hello StorageServiceProvider Provider');\r\n    this.documentsList = [];\r\n\r\n    // @TODO - think about putting in checks here is documentsList is empty, \r\n    // or there could be a async race issue if they take too long to come back\r\n    this.getDocumentsIndex(true).then((data) => {\r\n      this.documentsList = data;\r\n    });\r\n\r\n\r\n\r\n  }\r\n\r\n  async getDocumentsIndex(refresh: boolean) {\r\n    if (refresh) {\r\n      let resp = await blockstack.getFile(this.indexFileName, { decrypt: true });\r\n      if (resp) {\r\n        this.documentsList = JSON.parse(resp);\r\n      }\r\n      if (this.documentsList == null || !resp) {\r\n        this.documentsList = JSON.parse(await blockstack.putFile(this.indexFileName, \"[]\", { encrypt: true }));\r\n      }\r\n      this.documentsListFiltered = this.documentsList;\r\n    }\r\n    return this.documentsList;\r\n  }\r\n\r\n\r\n  async addDocument(fileName: string, fileBuffer: any) {\r\n    let newDocument = new Document();\r\n    newDocument.fileName = fileName;\r\n    newDocument.documentKey = this.generateKey();\r\n    newDocument.code = this.generateKey();\r\n\r\n    // write to /api/Code?docGuid=12345&code=12345\r\n    await this.writeCode(newDocument.guid, newDocument.code);\r\n    // add my storage path - write to /api/DocStorageMap?docGuid=12345&code=12345&storagePath=urlEncode(pathToStorage)\r\n    await this.addDocStoragePath(newDocument.guid, newDocument.code, blockstack.loadUserData().profile.apps[window.location.origin]);\r\n\r\n    newDocument.pathAnnotatedDoc = blockstack.loadUserData().profile.apps[window.location.origin];\r\n    let profileData = await this.blockStackService.getProfileData();\r\n    let myEmail = null;\r\n    if (profileData){\r\n      myEmail = JSON.parse(profileData).email;\r\n    }\r\n    newDocument.paths = [{\r\n      name: blockstack.loadUserData().profile.name, \r\n      userId: blockstack.loadUserData().username, \r\n      email: myEmail,\r\n      appPublicKey: await this.blockStackService.getAppPublicKey(),\r\n      pathToStorage: blockstack.loadUserData().profile.apps[window.location.origin]\r\n    }];\r\n    newDocument.signer = [];\r\n    this.documentsList.push(newDocument);\r\n    await blockstack.putFile(this.indexFileName, JSON.stringify(this.documentsList), { encrypt: true });\r\n    this.docBuffer = fileBuffer;\r\n    this.currentDoc = newDocument;\r\n    let response = await this.addDocumentBytes(newDocument.guid, fileBuffer, newDocument.documentKey);\r\n    return this.documentsList;\r\n  }\r\n\r\n  async updateDocument(documentGuid, doc){\r\n    // find in array \r\n    let index = this.documentsList.findIndex(i => i.guid === documentGuid);\r\n    // update\r\n    if (index !== -1) {\r\n      this.documentsList[index] = doc;\r\n      // write document index\r\n      await blockstack.putFile(this.indexFileName, JSON.stringify(this.documentsList), { encrypt: true });\r\n      return true;\r\n    }\r\n    return false;\r\n  }\r\n\r\n \r\n\r\n  async removeDocument(document) {\r\n    // remove item\r\n    this.documentsList = (<any>this.documentsList).remove(document);\r\n    await blockstack.putFile(this.indexFileName, JSON.stringify(this.documentsList), { encrypt: true });\r\n    await this.removeDocumentBytes(document.guid);\r\n    // remove binary file\r\n    return this.documentsList;\r\n  }\r\n\r\n  async addDocumentBytes(guid: string, doc: any, documentKey: string) {\r\n    let encryptedDoc = this.ecryptDoc(doc, documentKey);\r\n    // add blank annotations file\r\n    await this.createAnnotations(guid);\r\n    // add blank log file\r\n    await this.getLog(guid,true);\r\n    return blockstack.putFile(guid + \".pdf\", encryptedDoc, { encrypt: false }).then((data) => { });\r\n  }\r\n\r\n  async getDocument(fileName: string, documentKey: string) {\r\n    let resp = await blockstack.getFile(fileName, { decrypt: false });\r\n    if (resp) {\r\n      let encryptedDoc = resp;\r\n      return this.decryptDoc(encryptedDoc, documentKey);\r\n    }\r\n    else {\r\n      return null;\r\n    }\r\n  }\r\n\r\n  async getDocumentByPath(docPath: string, docKey: string) {\r\n    let resp = await this.http.get(docPath).toPromise();\r\n    if (resp) {\r\n      let encryptedDoc = resp.text();\r\n      return this.decryptDoc(encryptedDoc, docKey);\r\n    }\r\n    else {\r\n      return of(null);\r\n    }\r\n  }\r\n\r\n  async copyDocument(newDocument: Document, guid: string, fileBuffer: any) {\r\n    console.log(\"file buffer\", fileBuffer);\r\n    console.log(\"guid\", guid);\r\n    console.log(\"doc\", newDocument);\r\n\r\n    let myName = null;\r\n    if (blockstack.loadUserData().profile.name){\r\n      myName = blockstack.loadUserData().profile.name;\r\n    }\r\n    let myUserId = null;\r\n    if(blockstack.loadUserData().username){\r\n      myUserId = blockstack.loadUserData().username;\r\n    }\r\n    let profileData = await this.blockStackService.getProfileData();\r\n    let myEmail = null;\r\n    if (profileData){\r\n      myEmail = JSON.parse(profileData).email;\r\n    }\r\n    \r\n    newDocument.paths.push({\r\n      name: myName, \r\n      userId: myUserId, \r\n      email: myEmail,\r\n      appPublicKey: await this.blockStackService.getAppPublicKey(),\r\n      pathToStorage: blockstack.loadUserData().profile.apps[window.location.origin]\r\n    });\r\n\r\n    this.documentsList.push(newDocument);\r\n    console.log(\"new doc list\", this.documentsList );\r\n    await blockstack.putFile(this.indexFileName, JSON.stringify(this.documentsList), { encrypt: true });\r\n    this.currentDoc = newDocument;\r\n    //let response = await this.addDocumentBytes(guid, fileBuffer, newDocument.documentKey);\r\n    this.docBuffer = fileBuffer;\r\n    let encryptedDoc = this.ecryptDoc(fileBuffer, this.currentDoc.documentKey);\r\n    let r = await blockstack.putFile(guid + \".pdf\", encryptedDoc, { encrypt: false }).then((data) => { });\r\n\r\n\r\n    // add my storage path - write to /api/DocStorageMap?docGuid=12345&code=12345&storagePath=urlEncode(pathToStorage)\r\n    await this.addDocStoragePath(newDocument.guid, newDocument.code, blockstack.loadUserData().profile.apps[window.location.origin]);\r\n\r\n    //  now copy annotations\r\n    let annotsResp = await this.getAnnotationsByPath(this.currentDoc.pathAnnotatedDoc + guid + \".annotations.json\", this.currentDoc.documentKey);\r\n    if (annotsResp) {\r\n      this.saveAnnotations(guid, this.currentDocAnnotations.annotations);\r\n    }\r\n    else{\r\n      this.saveAnnotations(guid, \"\");\r\n    }\r\n\r\n    // now copy chat log\r\n    let theirPath = jslinq(this.currentDoc.paths).where( (el) => el.email != this.blockStackService.profile.email  ).toList();\r\n    let theirUrl = theirPath[0].pathToStorage + guid + '.log.json';\r\n    let theirLogDoc = await this.getLogByPath(theirUrl, this.currentDoc.documentKey);\r\n    if (theirLogDoc) {\r\n      let logStr = Automerge.save(theirLogDoc);\r\n      await this.saveLog(guid, logStr);\r\n    }\r\n    else{\r\n      // nothing\r\n    }\r\n\r\n    return this.documentsList;\r\n  }\r\n\r\n  documentExists(guid): boolean {\r\n    let exists = false;\r\n    let docs = jslinq(this.documentsList).where(  (el) => el.guid == guid ).toList();\r\n    if (docs.length > 0){\r\n      exists = true;\r\n    }\r\n    return exists;\r\n  }\r\n\r\n\r\n  async removeDocumentBytes(guid: string) {\r\n    await blockstack.putFile(guid + \".annotations.json\", \"\", { encrypt: false });\r\n    await blockstack.putFile(guid + \".log.json\", \"\", { encrypt: false });\r\n    return blockstack.putFile(guid + \".pdf\", \"\", { encrypt: false }).then((data) => { });\r\n  }\r\n\r\n\r\n  async createAnnotations(guid: string) {\r\n    let json = {\r\n      annotations: \"\"\r\n    }\r\n    this.currentDocAnnotationsDoc = Automerge.init();\r\n    let commit = blockstack.loadUserData().profile.name + \" created annotations on \" + this.getDate(); \r\n    this.currentDocAnnotationsDoc = Automerge.change(this.currentDocAnnotationsDoc, commit, doc => {\r\n      doc.annots = [];\r\n    });\r\n    let saveAnnotStr = Automerge.save(this.currentDocAnnotationsDoc);\r\n    let encrypted = this.encryptString(saveAnnotStr, this.currentDoc.documentKey);\r\n    return await blockstack.putFile(guid + \".annotations.json\", encrypted, { encrypt: false });\r\n  }\r\n\r\n  async saveAnnotations(guid: string, annotation: string) {\r\n    let json = {\r\n      annotations: annotation\r\n    }\r\n    let commit = blockstack.loadUserData().profile.name + \" added annotation on \" + this.getDate(); \r\n    this.currentDocAnnotationsDoc = Automerge.change(this.currentDocAnnotationsDoc, commit, doc => {\r\n      doc.annots.insertAt(0, json);\r\n    });\r\n    let saveAnnotStr = Automerge.save(this.currentDocAnnotationsDoc);\r\n    let encrypted = this.encryptString(saveAnnotStr, this.currentDoc.documentKey);\r\n    return await blockstack.putFile(guid + \".annotations.json\", encrypted, { encrypt: false });\r\n  }\r\n\r\n  async getAnnotations(guid: string) {\r\n\r\n    let annoatationsFileName = guid + \".annotations.json\";\r\n    let resp = await blockstack.getFile(annoatationsFileName, { decrypt: false });\r\n    if (resp) {\r\n      let decrypted = this.decryptString(resp, this.currentDoc.documentKey);\r\n      this.currentDocAnnotationsDoc = Automerge.load(decrypted);\r\n      this.currentDocAnnotations =  this.currentDocAnnotationsDoc.annots[0];//JSON.parse(decrypted);\r\n      // now merge annotations\r\n      let theirPath = jslinq(this.docStorageMaps.storagePaths).where( (el) => el != blockstack.loadUserData().profile.apps[window.location.origin]  ).toList();\r\n      // @todo in the future maybe support mutiple parties signing a doc and allow more than 2 storage paths\r\n      let theirUrl = theirPath[0];\r\n      if (theirUrl){\r\n        let url = theirUrl + annoatationsFileName;\r\n        let theirResp = await this.http.get(url).toPromise(); \r\n        // now merge their doc into mine\r\n        if (theirResp){\r\n          let str = theirResp.text();\r\n          str = this.decryptString(str, this.currentDoc.documentKey);\r\n          let theirDoc = Automerge.load(str);\r\n          let finalDoc = Automerge.merge(theirDoc, this.currentDocAnnotationsDoc)\r\n          this.currentDocAnnotationsDoc = finalDoc;\r\n        }\r\n      }\r\n      this.currentDocAnnotations = this.currentDocAnnotationsDoc.annots[0];\r\n\r\n    }\r\n    if (!resp) {\r\n      this.currentDocAnnotations = \"\";\r\n    }\r\n\r\n   \r\n    return this.currentDocAnnotations;\r\n  }\r\n\r\n  async getAnnotationsByPath(docPath: string, docKey: string): Promise<any> {\r\n    // @todo WIP\r\n    let resp = await this.http.get(docPath).toPromise();\r\n    if (resp) {\r\n      let encryptedDocStr = JSON.stringify(resp.json());\r\n      let annotations = this.decryptString(encryptedDocStr, docKey);\r\n      this.currentDocAnnotationsDoc = Automerge.load(annotations);\r\n      this.currentDocAnnotations =  this.currentDocAnnotationsDoc.annots[0];\r\n      //this.currentDocAnnotations = JSON.parse(annotations);\r\n    }\r\n    if (!resp) {\r\n      this.currentDocAnnotations = \"\";\r\n    }\r\n    return this.currentDocAnnotations;\r\n  }\r\n\r\n\r\n  async setCurrentDoc(guid: string) {\r\n    //alert('set curr doc');\r\n    this.currentDoc = this.documentsList.find(x => x.guid == guid);\r\n\r\n    await this.getDocStorageMaps(this.currentDoc.guid);\r\n\r\n    this.events.publish('documentService:setCurrentDoc', this.currentDoc);\r\n    let span = \"span:contains('\" + this.currentDoc.fileName + \"')\";\r\n    $(document).ready(function () {\r\n      $(\".channels-list-text li\").removeClass('active');\r\n      let s = $(span);\r\n      s.parent().addClass('active');\r\n    });\r\n  }\r\n\r\n\r\n  //#region Log (Chat)\r\n  async getLog(guid: string, create?: boolean) {\r\n    let logFileName = guid + '.log.json';\r\n    let resp = null;\r\n    try {\r\n\r\n      if (!create){\r\n        resp = await blockstack.getFile(logFileName, { decrypt: false }); \r\n      }\r\n     \r\n      // existing doc\r\n      if (resp) {\r\n          this.logDoc = this.decryptString(resp, this.currentDoc.documentKey);\r\n          this.logDoc =  Automerge.load(this.logDoc);\r\n          this.log = this.logDoc.log;\r\n          let theirPath = jslinq(this.docStorageMaps.storagePaths).where( (el) => el != blockstack.loadUserData().profile.apps[window.location.origin]  ).toList();\r\n          let theirUrl = theirPath[0];\r\n          if (theirUrl){\r\n            let url = theirUrl + logFileName;\r\n            let theirResp = await this.http.get(url).toPromise(); \r\n            // now merge their doc into mine\r\n            if (theirResp){\r\n              let str = theirResp.text();\r\n              str = this.decryptString(str, this.currentDoc.documentKey);\r\n              let theirDoc = Automerge.load(str);\r\n              let finalDoc = Automerge.merge(theirDoc, this.logDoc)\r\n              this.logDoc = finalDoc;\r\n            }\r\n          }\r\n          this.log = this.logDoc.log;\r\n      }\r\n      // init new doc\r\n      else {\r\n        let newLog = new Log();\r\n        newLog.messages = [];\r\n        let msg = new Message();\r\n        msg.createdBy = this.blockStackService.userName;\r\n        msg.createdByName = this.blockStackService.profileName;\r\n        msg.email = this.blockStackService.profile.email;\r\n        msg.message = \"Created Doc\";\r\n        newLog.messages.push(msg);\r\n        this.logDoc = Automerge.init();\r\n        this.logDoc = Automerge.change(this.logDoc, 'Initialize log - ' + this.getDate(), doc => {\r\n          doc.log = newLog;\r\n        });\r\n        let logStr = Automerge.save(this.logDoc);\r\n        logStr = this.encryptString(logStr, this.currentDoc.documentKey)\r\n        logStr = await blockstack.putFile(logFileName, logStr, { encrypt: false });\r\n        logStr = this.decryptString(logStr, this.currentDoc.documentKey);\r\n        console.log('logstr', logStr);\r\n        this.logDoc = Automerge.load(logStr);\r\n        this.log = this.logDoc.log;\r\n        //this.log = JSON.parse(await blockstack.putFile(logFileName, JSON.stringify(newLog), { encrypt: false }));\r\n      }\r\n      return this.log;\r\n    }\r\n    catch (e) {\r\n      //throw e;\r\n    }\r\n  }\r\n\r\n  async saveLog(guid: string, logStr: string) {\r\n    let logFileName = guid + '.log.json';\r\n    logStr = this.encryptString(logStr, this.currentDoc.documentKey)\r\n    logStr = await blockstack.putFile(logFileName, logStr, { encrypt: false });\r\n  }\r\n\r\n  async getLogByPath(docPath, docKey){\r\n     let resp = await this.http.get(docPath).toPromise();\r\n     if (resp) {\r\n       let encryptedDocStr = JSON.stringify(resp.json());\r\n       let chatLog = this.decryptString(encryptedDocStr, docKey);\r\n       this.logDoc = Automerge.load(chatLog);\r\n       this.log =  this.logDoc.log;\r\n     }\r\n     if (!resp) {\r\n       this.log = null;\r\n     }\r\n    return this.logDoc;\r\n  }\r\n\r\n  async addMessage(guid: string, message: string) {\r\n    let logFileName = guid + \".log.json\"\r\n    let log = await this.getLog(guid);\r\n    if (log) {\r\n      let msg = new Message();\r\n      msg.message =  message; //encodeURIComponent(message);\r\n      msg.createdBy = this.blockStackService.userName;\r\n      msg.createdByName = this.blockStackService.profileName\r\n      msg.email = this.blockStackService.profile.email;\r\n      this.logDoc = Automerge.change(this.logDoc, msg.createdByName + \" added message at \" + this.getDate() ,  (doc) => {\r\n        doc.log.messages.push(msg);\r\n      });\r\n      //log.messages.push(msg);\r\n      let logStr = Automerge.save(this.logDoc);\r\n      logStr = this.encryptString(logStr, this.currentDoc.documentKey);\r\n      await blockstack.putFile(logFileName, logStr, { encrypt: false });\r\n      this.log = this.logDoc.log;\r\n      this.events.publish('documentService:addedChat', msg);\r\n      return this.log;\r\n      //return await blockstack.putFile(logFileName, JSON.stringify(log), { encrypt: false });\r\n    }\r\n    else {\r\n      console.error(\"error getting log file: \" + logFileName)\r\n    }\r\n  }\r\n  //#endregion\r\n\r\n\r\n  async updatePartnerPathData(){\r\n    \r\n  }\r\n\r\n  async writeCode(docGuid, code){\r\n    return this.http.get(this.urlBlockusign + \"/api/Code?docGuid=\"+docGuid+\"&code=\" + code).toPromise();\r\n  }\r\n\r\n  async addDocStoragePath(docGuid, code, storagePath){\r\n    var encodedStoragePath = encodeURIComponent(storagePath);\r\n    var url = \"/api/DocStorageMap?docGuid=\"+docGuid+\"&code=\" + code + \"&storagePath=\" + encodedStoragePath;\r\n    return this.http.get(this.urlBlockusign + url).toPromise();\r\n  }\r\n\r\n\r\n  async getDocStorageMaps(docGuid){\r\n    var resp = await this.http.get(this.urlBlockusignGlobalStore + \"/\" + docGuid + \".doc.storage.map.json\").toPromise();\r\n    this.docStorageMaps = resp.json();\r\n    return this.docStorageMaps;\r\n  }\r\n\r\n \r\n\r\n  //#region Encryption\r\n  //https://stackoverflow.com/questions/26734033/encrypting-files-with-sjcl-client-side\r\n  ecryptDoc(doc: any, key: string) {\r\n    let docBits = sjcl.codec.arrayBuffer.toBits(doc);\r\n    let base64bits = sjcl.codec.base64.fromBits(docBits);\r\n    let encryptedDoc = sjcl.encrypt(key, base64bits);\r\n    return encryptedDoc;\r\n  }\r\n  decryptDoc(encryptedDoc, key: string) {\r\n    let dec = sjcl.decrypt(key, encryptedDoc);\r\n    let decryptedBase64 = sjcl.codec.base64.toBits(dec);\r\n    let decryptedDocBits = sjcl.codec.arrayBuffer.fromBits(decryptedBase64);\r\n    return decryptedDocBits;\r\n  }\r\n  encryptString(payload:string, key: string) {\r\n    let encryptedDoc = sjcl.encrypt(key, payload);\r\n    return encryptedDoc;\r\n  }\r\n  decryptString(payload: string, key: string) {\r\n    let dec = sjcl.decrypt(key, payload);\r\n    return dec;\r\n  }\r\n  generateKey() {\r\n    return (<any>window).guid();\r\n  }\r\n  //#endregion\r\n\r\n  // watchout\r\n  async resetStorage() {\r\n    await blockstack.putFile(this.indexFileName, \"[]\", { encrypt: true });\r\n  }\r\n\r\n  getDate() {\r\n    let d = Date();\r\n    return d;\r\n  }\r\n\r\n  async filterDocuments(signer){\r\n    if (signer == \"all\"){\r\n      this.documentsListFiltered = this.documentsList;\r\n    }\r\n    else{\r\n      this.documentsListFiltered = jslinq(this.documentsList).where( (el) => el.signer[0] == signer ).toList();\r\n    } \r\n    return this.documentsListFiltered;\r\n  }\r\n\r\n  \r\n}\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/services/document.service.ts","import { NgModule } from '@angular/core';\r\nimport { AbsoluteDragDirective } from './absolute-drag/absolute-drag';\r\n@NgModule({\r\n\tdeclarations: [AbsoluteDragDirective],\r\n\timports: [],\r\n\texports: [AbsoluteDragDirective]\r\n})\r\nexport class DirectivesModule {}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/directives/directives.module.ts","import { NgModule } from '@angular/core';\r\nimport { IonicPageModule } from 'ionic-angular';\r\nimport { EmailPage } from './email';\r\nimport { BlockStepsComponentModule } from '../../components/components.module';\r\nimport { NgSelectModule } from '@ng-select/ng-select';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { ReactiveFormsModule } from '@angular/forms';\r\n\r\n@NgModule({\r\n  declarations: [\r\n    EmailPage,\r\n  ],\r\n  imports: [\r\n    IonicPageModule.forChild(EmailPage),\r\n    BlockStepsComponentModule,\r\n    NgSelectModule,\r\n    FormsModule,\r\n    ReactiveFormsModule\r\n  ],\r\n  providers: [\r\n    \r\n  ]\r\n})\r\nexport class EmailPageModule { }\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/email/email.module.ts","import { Injectable } from '@angular/core';\r\nimport { Document } from './../models/models';\r\nimport 'rxjs/add/operator/toPromise';\r\nimport { Http, Response, Headers, RequestOptionsArgs, RequestOptions } from '@angular/http';\r\nimport { HttpHeaders } from '@angular/common/http';\r\nimport { Observable } from 'rxjs/Observable';\r\nimport 'rxjs/add/operator/map';\r\nimport 'rxjs/add/operator/catch';\r\nimport { AnonymousSubject } from 'rxjs/Subject';\r\nimport { Events } from 'ionic-angular';\r\ndeclare let blockstack: any;\r\n\r\n/*\r\n  Generated class for the StorageServiceProvider provider.\r\n\r\n  See https://angular.io/guide/dependency-injection for more info on providers\r\n  and Angular DI.\r\n*/\r\n@Injectable()\r\nexport class EmailService {\r\n\r\n  //url = \"https://api.sendgrid.com/v3/mail/send\";\r\n  //apiK = \"\";\r\n  url = \"https://blockusign.co/api/email\";\r\n  //url = \"http://localhost:5000/api/email\";\r\n\r\n\r\n  constructor(public events: Events, public http: Http) {\r\n\r\n  }\r\n\r\n  async sendEmail (to, subject, content) {\r\n\r\n    if (!to || !subject || !content){\r\n      alert('Must add an email address');\r\n      return;\r\n    }\r\n\r\n    let data = {\r\n      \"to\": to, \r\n      \"subject\": subject, \r\n      \"content\": content\r\n    };\r\n    let httpOptions = new RequestOptions();\r\n    httpOptions.headers = new Headers(\r\n      {\r\n        'Content-Type': 'application/json'\r\n      }\r\n    );\r\n\r\n    let resp = await this.http.post(this.url, JSON.stringify(data), httpOptions).toPromise();\r\n    return resp;\r\n\r\n  }\r\n  \r\n  async updateCachedEmails(){\r\n\r\n  }\r\n\r\n  // @todo when you send a document to an email address save it, so weh can query it in the lookup next time\r\n  async getCachedEmails(){\r\n    \r\n  }\r\n\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/services/email.service.ts","import { NgModule } from '@angular/core';\r\nimport { IonicPageModule } from 'ionic-angular';\r\nimport { ReviewPage } from './review';\r\nimport { BlockStepsComponentModule } from '../../components/components.module';\r\n\r\n@NgModule({\r\n  declarations: [\r\n    ReviewPage,\r\n  ],\r\n  imports: [\r\n    IonicPageModule.forChild(ReviewPage),\r\n    BlockStepsComponentModule\r\n  ],\r\n})\r\nexport class ReviewPageModule {}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/review/review.module.ts","import { NgModule } from '@angular/core';\r\nimport { IonicPageModule } from 'ionic-angular';\r\nimport { SignPage } from './sign';\r\nimport { BlockStepsComponentModule } from '../../components/components.module';\r\n\r\n@NgModule({\r\n  declarations: [\r\n    SignPage,\r\n  ],\r\n  imports: [\r\n    IonicPageModule.forChild(SignPage),\r\n    BlockStepsComponentModule\r\n  ],\r\n})\r\nexport class SignPageModule {}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/sign/sign.module.ts","import { IonicPageModule, IonicModule } from \"ionic-angular\";\r\nimport { HomePage } from \"./home\";\r\nimport { NgModule, CUSTOM_ELEMENTS_SCHEMA } from \"@angular/core\";\r\nimport { BlockStepsComponentModule } from '../../components/components.module';\r\n//import { BlockStepsComponent } from '../../components/block-steps/block-steps';\r\n\r\n@NgModule({\r\n    declarations: [\r\n      HomePage,\r\n      //BlockStepsComponent\r\n    ],\r\n    imports: [\r\n      IonicPageModule.forChild(HomePage),\r\n      BlockStepsComponentModule\r\n    ],\r\n    entryComponents: [\r\n        HomePage\r\n    ],\r\n    schemas: [ CUSTOM_ELEMENTS_SCHEMA ]\r\n  })\r\n  export class HomeModule {}\n\n\n// WEBPACK FOOTER //\n// ./src/pages/home/home.module.ts","import { Component, ViewChild } from '@angular/core';\r\nimport { NavController, IonicPage } from 'ionic-angular';\r\nimport { Chart } from 'chart.js';\r\nimport { AnnotatePage } from '../annotate/annotate';\r\nimport moment from 'moment-timezone';\r\nimport 'rxjs/add/operator/toPromise';\r\nimport { LoadingController } from 'ionic-angular';\r\nimport { prototype } from 'long';\r\nimport __pdfjs from 'pdfjs-dist/build/pdf';\r\nimport PDFJSAnnotate from 'pdf-annotate';\r\nimport { GlobalService } from '../../services/global.service';\r\nimport { DocumentService } from '../../services/document.service';\r\nimport { AlertController } from 'ionic-angular';\r\ndeclare let window: any;\r\ndeclare let PDFView: any;\r\ndeclare let canvas: any;\r\ndeclare let TextEncoder: any;\r\ndeclare let FileReader: any;\r\ndeclare let blockstack: any;\r\ndeclare let document: any;\r\ndeclare let jsPDF: any;\r\ndeclare let $: any;\r\ndeclare let sjcl: any;\r\n\r\n//const $ = document.querySelectorAll.bind(document);\r\n\r\n/// Pdf js basic example - https://jsfiddle.net/pdfjs/cq0asLqz/?utm_source=website&utm_medium=embed&utm_campaign=cq0asLqz\r\n/// Annotations sample - http://jsfiddle.net/seikichi/RuDvz/2/\r\n\r\n@IonicPage()\r\n@Component({\r\n    selector: 'page-home',\r\n    templateUrl: 'home.html'\r\n})\r\nexport class HomePage {\r\n\r\n    name: string;\r\n    isLoggedIn = false;\r\n    loginState = \"Login\";\r\n    fileName = \"blockusign/pdf1.pdf\";\r\n    profile: any;\r\n    pdfBuffer: any;\r\n    canvasCamera: any;\r\n    cameraContext: any;\r\n    loading;\r\n\r\n    constructor(\r\n        public navCtrl: NavController, \r\n        public loadingCtrl: LoadingController,\r\n        public globalService: GlobalService, \r\n        public documentService: DocumentService, \r\n        public alertCtrl: AlertController\r\n    ) {\r\n\r\n    }\r\n\r\n    async ionViewDidLoad() {\r\n\r\n        //this.initCamera();\r\n        this.ekUpload();\r\n\r\n        //let docs = await this.documentService.getDocumentsIndex(true)\r\n        //this.testPublicKeyFile();\r\n    }\r\n\r\n    next() {\r\n\r\n        //this.navCtrl.push(AnnotatePage)\r\n        //this.navCtrl.setRoot(ListPage);\r\n        this.navCtrl.push(\"AnnotatePage\", {\r\n            guid: this.documentService.currentDoc.guid\r\n        });\r\n    }\r\n\r\n    async saveFile(fileName) {\r\n\r\n\r\n        let documentList = await this.documentService.addDocument(fileName, this.pdfBuffer);\r\n        this.next();\r\n\r\n        // blockstack.putFile(fileName, this.pdfBuffer, { encrypt: true }).then((data) => {\r\n        //     this.next();\r\n        // });\r\n    }\r\n\r\n    async getFile() {\r\n        let data = this.documentService.getDocument(this.fileName, this.documentService.currentDoc.documentKey);\r\n        this.pdfBuffer = data;\r\n    }\r\n\r\n    loadFile() {\r\n\r\n        this.loading = this.loadingCtrl.create({\r\n            content: 'Please wait...'\r\n          });\r\n        //this.loading.present();\r\n\r\n        let fileInput: any = document.getElementById('file-upload');\r\n        let firstFile = fileInput.files[0];\r\n\r\n        let startByte = 0;\r\n        let endByte = firstFile.size;\r\n        let opt_startByte = startByte.toString();\r\n        let opt_stopByte = endByte.toString();\r\n        let files = (<any>document).getElementById('file-upload').files;\r\n        if (!files.length) {\r\n            alert('Please select a file!');\r\n            return;\r\n        }\r\n        let file = files[0];\r\n        let start = parseInt(opt_startByte) || 0;\r\n        let stop = parseInt(opt_stopByte) || file.size - 1;\r\n        let filename = \"\";\r\n        let reader = new FileReader();\r\n        // If we use onloadend, we need to check the readyState.\r\n        reader.onloadend = (evt: any) => {\r\n            if (evt.target.readyState == FileReader.DONE) {\r\n                // document.getElementById('byte_content').textContent = evt.target.result;\r\n                // document.getElementById('byte_range').textContent =\r\n                //     ['Read bytes: ', start + 1, ' - ', stop + 1,\r\n                //         ' of ', file.size, ' byte file'].join('');\r\n            }\r\n            filename = fileInput.files[0].name;\r\n            this.newDocModal(filename);\r\n            //localStorage.setItem(\"FileName\", filename);\r\n        };\r\n\r\n        let blob = file.slice(start, stop + 1);\r\n        //reader.readAsBinaryString(blob);\r\n        reader.onload = (evt: any) => {\r\n            let arraybuffer = evt.target.result;\r\n            this.pdfBuffer = arraybuffer;\r\n            //this.saveFile();\r\n            let pdfData = new Uint8Array(arraybuffer);\r\n            //this.savePdfAsString(pdfData);\r\n            this.createPdf(pdfData);\r\n        };\r\n        reader.readAsArrayBuffer(blob);\r\n    }\r\n\r\n    createPdf(pdfData) {\r\n        // Loaded via <script> tag, create shortcut to access PDF.js exports.\r\n        let pdfjsLib = window['pdfjs-dist/build/pdf'];\r\n\r\n        pdfjsLib.workerSrc = '//mozilla.github.io/pdf.js/build/pdf.worker.js';\r\n        PDFJSAnnotate.setStoreAdapter(new PDFJSAnnotate.LocalStoreAdapter());\r\n\r\n        let loadingTask = pdfjsLib.getDocument({ data: pdfData });\r\n\r\n        loadingTask.promise.then((pdf) => {\r\n            console.log('PDF loaded');\r\n            let pageNumber = 1;\r\n            pdf.getPage(pageNumber).then((page) => {\r\n                console.log('Page loaded');\r\n                let scale = 1.5;\r\n                let viewport = page.getViewport(scale);\r\n\r\n                // Prepare canvas using PDF page dimensions\r\n                let canvas: any = document.getElementById('the-canvas');\r\n                let context = canvas.getContext('2d');\r\n                canvas.height = viewport.height;\r\n                canvas.width = viewport.width;\r\n\r\n                // Render PDF page into canvas context\r\n                let renderContext = {\r\n                    canvasContext: context,\r\n                    viewport: viewport\r\n                };\r\n                let renderTask = page.render(renderContext);\r\n                renderTask.then(() => {\r\n                    console.log('Page rendered');\r\n                    this.loading.dismiss();\r\n                });\r\n            });\r\n\r\n        }, (reason) => {\r\n            // PDF loading error\r\n            console.error(reason);\r\n            this.loading.dismiss();\r\n        });\r\n    }\r\n\r\n    savePdfAsString(pdf) {\r\n        this.largeuint8ArrToString(pdf, (strPdf) => {\r\n            let base64StringPdf = btoa(strPdf);\r\n            //localStorage.setItem(\"pdfStr\", base64StringPdf);\r\n        });\r\n    }\r\n\r\n    getPdfFromString(base64PdfString) {\r\n        // decode base64 string, remove space for IE compatibility\r\n        let binary = atob(base64PdfString.replace(/\\s/g, ''));\r\n        let len = binary.length;\r\n        let arraybuffer = new ArrayBuffer(len);\r\n        let pdfData = new Uint8Array(arraybuffer);\r\n    }\r\n\r\n    largeuint8ArrToString(uint8arr, callback) {\r\n        let bb = new Blob([uint8arr]);\r\n        let f = new FileReader();\r\n        f.onload = (e: any) => {\r\n            callback(e.target.result);\r\n        };\r\n        f.readAsBinaryString(bb);\r\n    }\r\n\r\n    // File Upload https://codepen.io/mattsince87/pen/yadZXv?editors=0010#0\r\n    ekUpload() {\r\n        let self = this;\r\n        function Init() {\r\n\r\n            console.log(\"Upload Initialised\");\r\n\r\n            var fileSelect = document.getElementById('file-upload'),\r\n                fileDrag = document.getElementById('file-drag'),\r\n                submitButton = document.getElementById('submit-button');\r\n\r\n            fileSelect.addEventListener('change', fileSelectHandler, false);\r\n\r\n            // Is XHR2 available?\r\n            var xhr = new XMLHttpRequest();\r\n            if (xhr.upload) {\r\n                // File Drop\r\n                fileDrag.addEventListener('dragover', fileDragHover, false);\r\n                fileDrag.addEventListener('dragleave', fileDragHover, false);\r\n                fileDrag.addEventListener('drop', fileSelectHandler, false);\r\n            }\r\n        }\r\n\r\n        function fileDragHover(e) {\r\n            var fileDrag = document.getElementById('file-drag');\r\n\r\n            e.stopPropagation();\r\n            e.preventDefault();\r\n\r\n            fileDrag.className = (e.type === 'dragover' ? 'hover' : 'modal-body file-upload');\r\n        }\r\n\r\n        function fileSelectHandler(e) {\r\n            // Fetch FileList object\r\n            var files = e.target.files || e.dataTransfer.files;\r\n\r\n            // Cancel event and hover styling\r\n            fileDragHover(e);\r\n\r\n\r\n            // Process all File objects\r\n            for (var i = 0, f; f = files[i]; i++) {\r\n                // parseFile(f);\r\n                self.loadFile();\r\n                uploadFile(f);\r\n\r\n            }\r\n        }\r\n\r\n        // Output\r\n        function output(msg) {\r\n            // Response\r\n            var m = document.getElementById('messages');\r\n            m.innerHTML = msg;\r\n        }\r\n\r\n\r\n        function setProgressMaxValue(e) {\r\n            var pBar = document.getElementById('file-progress');\r\n\r\n            if (e.lengthComputable) {\r\n                pBar.max = e.total;\r\n            }\r\n        }\r\n\r\n        function updateFileProgress(e) {\r\n            var pBar = document.getElementById('file-progress');\r\n\r\n            if (e.lengthComputable) {\r\n                pBar.value = e.loaded;\r\n            }\r\n        }\r\n\r\n        function uploadFile(file) {\r\n\r\n            var xhr = new XMLHttpRequest(),\r\n                fileInput = document.getElementById('class-roster-file'),\r\n                pBar = document.getElementById('file-progress'),\r\n                fileSizeLimit = 2048; // In MB\r\n            if (xhr.upload) {\r\n                // Check if file is less than x MB\r\n                if (file.size <= fileSizeLimit * 1024 * 1024) {\r\n                    // Progress bar\r\n                    pBar.style.display = 'inline';\r\n                    xhr.upload.addEventListener('loadstart', setProgressMaxValue, false);\r\n                    xhr.upload.addEventListener('progress', updateFileProgress, false);\r\n\r\n                    // File received / failed\r\n                    xhr.onreadystatechange = function (e) {\r\n                        if (xhr.readyState == 4) {\r\n                            // Everything is good!\r\n\r\n                            // progress.className = (xhr.status == 200 ? \"success\" : \"failure\");\r\n                            // document.location.reload(true);\r\n                        }\r\n                    };\r\n\r\n                    // Start upload\r\n                    xhr.open('POST', document.getElementById('file-upload-form').action, true);\r\n                    xhr.setRequestHeader('X-File-Name', file.name);\r\n                    xhr.setRequestHeader('X-File-Size', file.size);\r\n                    xhr.setRequestHeader('Content-Type', 'multipart/form-data');\r\n                    xhr.send(file);\r\n                } else {\r\n                    output('Please upload a smaller file (< ' + fileSizeLimit + ' MB).');\r\n                }\r\n            }\r\n        }\r\n\r\n        // Check for the various File API support.\r\n        if (window.File && window.FileList && window.FileReader) {\r\n            Init();\r\n        } else {\r\n            document.getElementById('file-drag').style.display = 'none';\r\n        }\r\n    }\r\n\r\n\r\n\r\n    newDocModal(fileName) {\r\n\r\n        let alert = this.alertCtrl.create({\r\n            title: 'Document Name',\r\n            inputs: [\r\n                {\r\n                    name: 'fileName',\r\n                    placeholder: '',\r\n                    value: fileName\r\n                }\r\n            ],\r\n            buttons: [\r\n                {\r\n                    text: 'Cancel',\r\n                    role: 'cancel',\r\n                    handler: data => {\r\n                        console.log('Cancel clicked');\r\n                    }\r\n                },\r\n                {\r\n                    text: 'Ok',\r\n                    handler: data => {\r\n\r\n                        // save here\r\n\r\n                        this.saveFile(data.fileName);\r\n\r\n                        if (true == true) {\r\n                            // logged in!\r\n                        } else {\r\n                            // invalid login\r\n                            return false;\r\n                        }\r\n                    }\r\n                }\r\n            ]\r\n        });\r\n        alert.present();\r\n    }\r\n\r\n\r\n    async initCamera() {\r\n\r\n        // rear camera selection - https://github.com/webrtc/samples/blob/gh-pages/src/content/devices/input-output/js/main.js\r\n        // https://www.html5rocks.com/en/tutorials/getusermedia/intro/\r\n        // @todo check rear camera logic on all phones\r\n        let devices = await navigator.mediaDevices.enumerateDevices();;\r\n\r\n        // find back camera\r\n        var rearCamera = devices.find((device) => { return (device.kind === 'videoinput' && device.label.includes('back')) });\r\n        let mediaOptions: any;\r\n\r\n        if (rearCamera) {\r\n            mediaOptions = {\r\n                deviceId: { exact: rearCamera.deviceId }\r\n            };\r\n        }\r\n        else {\r\n            mediaOptions = true;\r\n        }\r\n\r\n\r\n        let mediaConfig = {\r\n            video: mediaOptions\r\n        };\r\n\r\n        let playStream = function (video, src) {\r\n            video.src = src;\r\n            video.play();\r\n        };\r\n\r\n        // let process = (video) => {\r\n        //     let mediaDevices = navigator.mediaDevices;\r\n        //     mediaDevices.getUserMedia(mediaConfig).then(\r\n        //         stream => playStream(\r\n        //             video,\r\n        //             window.URL.createObjectURL(stream)\r\n        //         )\r\n        //     ).catch(function (err) {\r\n        //         // alert(err);\r\n        //         alert(\"Not support get stream from camera!\");\r\n        //     });\r\n        // };\r\n\r\n        let process = (video) => {\r\n            let mediaDevices = navigator.mediaDevices;\r\n            mediaDevices.getUserMedia(mediaConfig).then(function (stream) {\r\n                var videoTracks = stream.getVideoTracks();\r\n                console.log('Got stream with constraints:', mediaConfig);\r\n                console.log('Using video device: ' + videoTracks[0].label);\r\n                // stream.onended = function() {\r\n                //   console.log('Stream ended');\r\n                // };\r\n                window.stream = stream; // make variable available to console\r\n                video.srcObject = stream;\r\n            }).catch(function (err) {\r\n                // alert(err);\r\n                alert(\"Not support get stream from camera!\");\r\n            });\r\n        };\r\n\r\n\r\n\r\n        let video = $(\"#video\")[0];\r\n        process(video);\r\n\r\n        this.canvasCamera = $(\"#canvasCamera\")[0];\r\n        this.cameraContext = this.canvasCamera.getContext(\"2d\");\r\n\r\n        $(\"#snap\").on('click', () => {\r\n            this.cameraContext.drawImage(video, 0, 0, 612, 792);\r\n        });\r\n\r\n        $(\"#downloadpdf\").on('click', this.savePDF);\r\n\r\n    }\r\n\r\n    savePDF() {\r\n        try {\r\n            this.canvasCamera = $(\"#canvasCamera\")[0];\r\n            var imgData = this.canvasCamera.toDataURL(\"image/jpeg\", 1.0);\r\n            var pdf = new jsPDF('p', 'mm', [297, 210]);\r\n            pdf.addImage(imgData, 'JPEG', 5, 5);\r\n            var namefile = prompt(\"insert name of file\");\r\n            pdf.save(namefile + \".pdf\");\r\n        } catch (e) {\r\n            alert(\"Error description: \" + e.message);\r\n        }\r\n\r\n    }\r\n\r\n\r\n    testPublicKeyFile() {\r\n        const myPublicKey = blockstack.getPublicKeyFromPrivate(blockstack.loadUserData().appPrivateKey);\r\n        const yourPublicKey = \"02563f0f1d5c5429fa8fdb3d8fc4b0464dac70b07cd8249f0ef17bcf2c93ed7469\";\r\n\r\n        if (blockstack.loadUserData().profile.name == \"nick tee\") {\r\n\r\n            // write for you\r\n            this.testPutFile(yourPublicKey);\r\n            // write for me\r\n            this.testPutFile(myPublicKey).then(() => {\r\n                // read for me\r\n                this.testGetFile(myPublicKey);\r\n            });\r\n        }\r\n\r\n        if (blockstack.loadUserData().profile.name == \"Demo User BlockSign\") {\r\n            // read for me\r\n            this.testGetFile(myPublicKey);\r\n        }\r\n\r\n\r\n\r\n    }\r\n\r\n\r\n    testPutFile(publicKey): Promise<any> {\r\n        const encryptOptions = { encrypt: publicKey };\r\n        const path = \"testFile.json\";\r\n        let fileContent = \"{stuff: 'from nicktee.id'}\";\r\n\r\n        // put and encrypt the file\r\n        return blockstack.putFile(path, fileContent, encryptOptions)\r\n            .then((publicURL) => {\r\n                console.log(\"testPublicKeyFile ===> \" + publicURL);\r\n            });\r\n    }\r\n\r\n    testGetFile(publicKey): Promise<any> {\r\n        const decryptOptions = {\r\n            decrypt: true\r\n        };\r\n        let fullReadUrl = \"../../hub/18kTskBpTh1mznsypu1fhJ27dxbC1SwXEK/testFile.json\";\r\n\r\n        return blockstack.getFile(fullReadUrl, decryptOptions).then(readContent => {\r\n            console.log(\"testPublicKeyFile ===> \" + readContent);\r\n        });\r\n    }\r\n\r\n\r\n}\r\n\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/home/home.ts","import { Injectable } from '@angular/core';\r\n\r\n@Injectable()\r\nexport class GlobalService {\r\n\r\n\r\n    public GaiUrl: string;\r\n\r\n    constructor() { \r\n\r\n        this.GaiUrl = \"http://21312\";\r\n\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/services/global.service.ts","import { Component, ViewChild } from \"@angular/core\";\r\nimport { ViewController, NavController} from \"ionic-angular\";\r\nimport { DocumentService } from './../services/document.service';\r\nimport { ToastController } from 'ionic-angular';\r\n\r\n@Component({\r\n    template: `\r\n     <br/>\r\n      <ion-list style=\"\">\r\n        <button ion-item (click)=\"documentRemove()\">Delete</button>\r\n        <button ion-item (click)=\"close()\">CLOSE X</button>\r\n      </ion-list>\r\n    `\r\n  })\r\n  export class OptionsPopoverPage {\r\n    doc: any;\r\n    constructor(\r\n      public viewCtrl: ViewController, \r\n      public documentService: DocumentService, \r\n      private toastCtrl: ToastController,\r\n      private nav: NavController\r\n    ) {\r\n        this.doc = this.viewCtrl.data.selectedDoc;\r\n\r\n    }\r\n  \r\n    close() {\r\n      this.viewCtrl.dismiss();\r\n    }\r\n\r\n    async documentRemove(selectedDocument){\r\n        window.location.hash = '';\r\n        await this.documentService.removeDocument( this.doc );\r\n        let toast = this.toastCtrl.create({\r\n            message: 'Document deleted!',\r\n            duration: 3000,\r\n            position: 'middle'\r\n          });\r\n        toast.present();\r\n        \r\n        this.viewCtrl.dismiss();\r\n\r\n        window.location.hash = '';\r\n    }\r\n\r\n  }\n\n\n// WEBPACK FOOTER //\n// ./src/app/options.popover.page.ts","import { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\r\n\r\nimport { AppModule } from './app.module';\r\n\r\nplatformBrowserDynamic().bootstrapModule(AppModule);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/main.ts","import { BrowserModule } from '@angular/platform-browser';\r\nimport { ErrorHandler, NgModule} from '@angular/core';\r\nimport { IonicApp, IonicErrorHandler, IonicModule, IonicPageModule, List, NavController } from 'ionic-angular';\r\nimport { HttpModule, JsonpModule } from '@angular/http';\r\nimport { StatusBar } from '@ionic-native/status-bar';\r\nimport { SplashScreen } from '@ionic-native/splash-screen';\r\nimport { ChartsModule } from 'ng2-charts';\r\nimport { NgSelectModule } from '@ng-select/ng-select';\r\nimport { FormsModule } from '@angular/forms';\r\n\r\nimport { MyApp } from './app.component';\r\nimport { OptionsPopoverPage } from './options.popover.page';\r\nimport { DirectivesModule } from './../directives/directives.module';\r\nimport { HomeModule } from '../pages/home/home.module';\r\nimport { AnnotatePageModule } from '../pages/annotate/annotate.module';\r\nimport { SignPageModule } from '../pages/sign/sign.module';\r\nimport { EmailPageModule } from '../pages/email/email.module';\r\nimport { ReviewPageModule } from '../pages/review/review.module';\r\nimport { BlockStepsComponentModule } from './../components/components.module';\r\n\r\n\r\n\r\n//import { HomePage } from './../pages/home/home';\r\n//import { AnnotatePage } from './../pages/annotate/annotate';\r\n\r\nimport { CoinService } from '../services/coin.service';\r\nimport { GlobalService } from '../services/global.service'\r\nimport { CryptoCompareService } from '../services/cryptocompare.service';\r\nimport { SlackService } from '../services/slack.service';\r\nimport { DocumentService } from '../services/document.service';\r\nimport { EmailService } from '../services/email.service';\r\nimport { BlockStackService } from '../services/blockstack.service';\r\nimport { Block } from 'bitcoinjs-lib';\r\n\r\n\r\n\r\n@NgModule({\r\n  declarations: [\r\n    MyApp,\r\n    OptionsPopoverPage,\r\n  ],\r\n  imports: [\r\n    BrowserModule,\r\n    IonicModule.forRoot(MyApp, {\r\n      preloadModules: true\r\n    }),\r\n    DirectivesModule,\r\n    ChartsModule,\r\n    HttpModule,\r\n    JsonpModule,\r\n    HomeModule,\r\n    AnnotatePageModule,\r\n    SignPageModule,\r\n    EmailPageModule,\r\n    ReviewPageModule,\r\n    NgSelectModule, \r\n    FormsModule,\r\n    BlockStepsComponentModule\r\n  ],\r\n  bootstrap: [IonicApp],\r\n  entryComponents: [\r\n    MyApp,\r\n    OptionsPopoverPage\r\n  ],\r\n  providers: [\r\n    StatusBar,\r\n    SplashScreen,\r\n    BlockStackService,\r\n    CoinService,\r\n    CryptoCompareService,\r\n    SlackService,\r\n    GlobalService,\r\n    {provide: ErrorHandler, useClass: IonicErrorHandler},\r\n    DocumentService,\r\n    EmailService\r\n  ]\r\n})\r\nexport class AppModule {}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/app.module.ts","var map = {\n\t\"./af\": 250,\n\t\"./af.js\": 250,\n\t\"./ar\": 251,\n\t\"./ar-dz\": 252,\n\t\"./ar-dz.js\": 252,\n\t\"./ar-kw\": 253,\n\t\"./ar-kw.js\": 253,\n\t\"./ar-ly\": 254,\n\t\"./ar-ly.js\": 254,\n\t\"./ar-ma\": 255,\n\t\"./ar-ma.js\": 255,\n\t\"./ar-sa\": 256,\n\t\"./ar-sa.js\": 256,\n\t\"./ar-tn\": 257,\n\t\"./ar-tn.js\": 257,\n\t\"./ar.js\": 251,\n\t\"./az\": 258,\n\t\"./az.js\": 258,\n\t\"./be\": 259,\n\t\"./be.js\": 259,\n\t\"./bg\": 260,\n\t\"./bg.js\": 260,\n\t\"./bm\": 261,\n\t\"./bm.js\": 261,\n\t\"./bn\": 262,\n\t\"./bn.js\": 262,\n\t\"./bo\": 263,\n\t\"./bo.js\": 263,\n\t\"./br\": 264,\n\t\"./br.js\": 264,\n\t\"./bs\": 265,\n\t\"./bs.js\": 265,\n\t\"./ca\": 266,\n\t\"./ca.js\": 266,\n\t\"./cs\": 267,\n\t\"./cs.js\": 267,\n\t\"./cv\": 268,\n\t\"./cv.js\": 268,\n\t\"./cy\": 269,\n\t\"./cy.js\": 269,\n\t\"./da\": 270,\n\t\"./da.js\": 270,\n\t\"./de\": 271,\n\t\"./de-at\": 272,\n\t\"./de-at.js\": 272,\n\t\"./de-ch\": 273,\n\t\"./de-ch.js\": 273,\n\t\"./de.js\": 271,\n\t\"./dv\": 274,\n\t\"./dv.js\": 274,\n\t\"./el\": 275,\n\t\"./el.js\": 275,\n\t\"./en-au\": 276,\n\t\"./en-au.js\": 276,\n\t\"./en-ca\": 277,\n\t\"./en-ca.js\": 277,\n\t\"./en-gb\": 278,\n\t\"./en-gb.js\": 278,\n\t\"./en-ie\": 279,\n\t\"./en-ie.js\": 279,\n\t\"./en-il\": 280,\n\t\"./en-il.js\": 280,\n\t\"./en-nz\": 281,\n\t\"./en-nz.js\": 281,\n\t\"./eo\": 282,\n\t\"./eo.js\": 282,\n\t\"./es\": 283,\n\t\"./es-do\": 284,\n\t\"./es-do.js\": 284,\n\t\"./es-us\": 285,\n\t\"./es-us.js\": 285,\n\t\"./es.js\": 283,\n\t\"./et\": 286,\n\t\"./et.js\": 286,\n\t\"./eu\": 287,\n\t\"./eu.js\": 287,\n\t\"./fa\": 288,\n\t\"./fa.js\": 288,\n\t\"./fi\": 289,\n\t\"./fi.js\": 289,\n\t\"./fo\": 290,\n\t\"./fo.js\": 290,\n\t\"./fr\": 291,\n\t\"./fr-ca\": 292,\n\t\"./fr-ca.js\": 292,\n\t\"./fr-ch\": 293,\n\t\"./fr-ch.js\": 293,\n\t\"./fr.js\": 291,\n\t\"./fy\": 294,\n\t\"./fy.js\": 294,\n\t\"./gd\": 295,\n\t\"./gd.js\": 295,\n\t\"./gl\": 296,\n\t\"./gl.js\": 296,\n\t\"./gom-latn\": 297,\n\t\"./gom-latn.js\": 297,\n\t\"./gu\": 298,\n\t\"./gu.js\": 298,\n\t\"./he\": 299,\n\t\"./he.js\": 299,\n\t\"./hi\": 300,\n\t\"./hi.js\": 300,\n\t\"./hr\": 301,\n\t\"./hr.js\": 301,\n\t\"./hu\": 302,\n\t\"./hu.js\": 302,\n\t\"./hy-am\": 303,\n\t\"./hy-am.js\": 303,\n\t\"./id\": 304,\n\t\"./id.js\": 304,\n\t\"./is\": 305,\n\t\"./is.js\": 305,\n\t\"./it\": 306,\n\t\"./it.js\": 306,\n\t\"./ja\": 307,\n\t\"./ja.js\": 307,\n\t\"./jv\": 308,\n\t\"./jv.js\": 308,\n\t\"./ka\": 309,\n\t\"./ka.js\": 309,\n\t\"./kk\": 310,\n\t\"./kk.js\": 310,\n\t\"./km\": 311,\n\t\"./km.js\": 311,\n\t\"./kn\": 312,\n\t\"./kn.js\": 312,\n\t\"./ko\": 313,\n\t\"./ko.js\": 313,\n\t\"./ky\": 314,\n\t\"./ky.js\": 314,\n\t\"./lb\": 315,\n\t\"./lb.js\": 315,\n\t\"./lo\": 316,\n\t\"./lo.js\": 316,\n\t\"./lt\": 317,\n\t\"./lt.js\": 317,\n\t\"./lv\": 318,\n\t\"./lv.js\": 318,\n\t\"./me\": 319,\n\t\"./me.js\": 319,\n\t\"./mi\": 320,\n\t\"./mi.js\": 320,\n\t\"./mk\": 321,\n\t\"./mk.js\": 321,\n\t\"./ml\": 322,\n\t\"./ml.js\": 322,\n\t\"./mn\": 323,\n\t\"./mn.js\": 323,\n\t\"./mr\": 324,\n\t\"./mr.js\": 324,\n\t\"./ms\": 325,\n\t\"./ms-my\": 326,\n\t\"./ms-my.js\": 326,\n\t\"./ms.js\": 325,\n\t\"./mt\": 327,\n\t\"./mt.js\": 327,\n\t\"./my\": 328,\n\t\"./my.js\": 328,\n\t\"./nb\": 329,\n\t\"./nb.js\": 329,\n\t\"./ne\": 330,\n\t\"./ne.js\": 330,\n\t\"./nl\": 331,\n\t\"./nl-be\": 332,\n\t\"./nl-be.js\": 332,\n\t\"./nl.js\": 331,\n\t\"./nn\": 333,\n\t\"./nn.js\": 333,\n\t\"./pa-in\": 334,\n\t\"./pa-in.js\": 334,\n\t\"./pl\": 335,\n\t\"./pl.js\": 335,\n\t\"./pt\": 336,\n\t\"./pt-br\": 337,\n\t\"./pt-br.js\": 337,\n\t\"./pt.js\": 336,\n\t\"./ro\": 338,\n\t\"./ro.js\": 338,\n\t\"./ru\": 339,\n\t\"./ru.js\": 339,\n\t\"./sd\": 340,\n\t\"./sd.js\": 340,\n\t\"./se\": 341,\n\t\"./se.js\": 341,\n\t\"./si\": 342,\n\t\"./si.js\": 342,\n\t\"./sk\": 343,\n\t\"./sk.js\": 343,\n\t\"./sl\": 344,\n\t\"./sl.js\": 344,\n\t\"./sq\": 345,\n\t\"./sq.js\": 345,\n\t\"./sr\": 346,\n\t\"./sr-cyrl\": 347,\n\t\"./sr-cyrl.js\": 347,\n\t\"./sr.js\": 346,\n\t\"./ss\": 348,\n\t\"./ss.js\": 348,\n\t\"./sv\": 349,\n\t\"./sv.js\": 349,\n\t\"./sw\": 350,\n\t\"./sw.js\": 350,\n\t\"./ta\": 351,\n\t\"./ta.js\": 351,\n\t\"./te\": 352,\n\t\"./te.js\": 352,\n\t\"./tet\": 353,\n\t\"./tet.js\": 353,\n\t\"./tg\": 354,\n\t\"./tg.js\": 354,\n\t\"./th\": 355,\n\t\"./th.js\": 355,\n\t\"./tl-ph\": 356,\n\t\"./tl-ph.js\": 356,\n\t\"./tlh\": 357,\n\t\"./tlh.js\": 357,\n\t\"./tr\": 358,\n\t\"./tr.js\": 358,\n\t\"./tzl\": 359,\n\t\"./tzl.js\": 359,\n\t\"./tzm\": 360,\n\t\"./tzm-latn\": 361,\n\t\"./tzm-latn.js\": 361,\n\t\"./tzm.js\": 360,\n\t\"./ug-cn\": 362,\n\t\"./ug-cn.js\": 362,\n\t\"./uk\": 363,\n\t\"./uk.js\": 363,\n\t\"./ur\": 364,\n\t\"./ur.js\": 364,\n\t\"./uz\": 365,\n\t\"./uz-latn\": 366,\n\t\"./uz-latn.js\": 366,\n\t\"./uz.js\": 365,\n\t\"./vi\": 367,\n\t\"./vi.js\": 367,\n\t\"./x-pseudo\": 368,\n\t\"./x-pseudo.js\": 368,\n\t\"./yo\": 369,\n\t\"./yo.js\": 369,\n\t\"./zh-cn\": 370,\n\t\"./zh-cn.js\": 370,\n\t\"./zh-hk\": 371,\n\t\"./zh-hk.js\": 371,\n\t\"./zh-tw\": 372,\n\t\"./zh-tw.js\": 372\n};\nfunction webpackContext(req) {\n\treturn __webpack_require__(webpackContextResolve(req));\n};\nfunction webpackContextResolve(req) {\n\tvar id = map[req];\n\tif(!(id + 1)) // check for number or string\n\t\tthrow new Error(\"Cannot find module '\" + req + \"'.\");\n\treturn id;\n};\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 563;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/moment/locale ^\\.\\/.*$\n// module id = 563\n// module chunks = 1","/* (ignored) */\n\n\n//////////////////\n// WEBPACK FOOTER\n// util (ignored)\n// module id = 574\n// module chunks = 1","/* (ignored) */\n\n\n//////////////////\n// WEBPACK FOOTER\n// fs (ignored)\n// module id = 593\n// module chunks = 1","/* (ignored) */\n\n\n//////////////////\n// WEBPACK FOOTER\n// http (ignored)\n// module id = 594\n// module chunks = 1","/* (ignored) */\n\n\n//////////////////\n// WEBPACK FOOTER\n// https (ignored)\n// module id = 595\n// module chunks = 1","import { NgModule, ModuleWithProviders } from '@angular/core';\r\nimport { BlockStepsComponent } from './block-steps/block-steps';\r\nimport { IonicModule } from 'ionic-angular';\r\nimport { BlockPdfComponent } from './block-pdf/block-pdf';\r\nimport { DirectivesModule } from '../directives/directives.module';\r\nimport { BlockChatComponent } from './block-chat/block-chat';\r\n\r\n\r\n@NgModule({\r\n    declarations: [BlockStepsComponent,\r\n        BlockPdfComponent,\r\n    BlockChatComponent],\r\n    imports: [\r\n        IonicModule,\r\n        DirectivesModule\r\n    ],\r\n    exports: [BlockStepsComponent,\r\n        BlockPdfComponent,\r\n    BlockChatComponent]\r\n})\r\nexport class BlockStepsComponentModule {\r\n    static forRoot(): ModuleWithProviders {\r\n        return {\r\n            ngModule: BlockStepsComponentModule,\r\n            providers: [\r\n            ]\r\n        };\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/components.module.ts","import { Component, Input } from '@angular/core';\r\nimport { NavController, IonicPage, AlertController } from 'ionic-angular';\r\nimport { DocumentService } from '../../services/document.service';\r\ndeclare let $: any;\r\n\r\n/**\r\n * Generated class for the BlockStepsComponent component.\r\n *\r\n * See https://angular.io/api/core/Component for more info on Angular\r\n * Components.\r\n */\r\n@Component({\r\n  selector: 'block-steps',\r\n  templateUrl: 'block-steps.html'\r\n})\r\nexport class BlockStepsComponent {\r\n\r\n  @Input() activeStep;\r\n  \r\n  text: string;\r\n\r\n  constructor(\r\n    private nav: NavController, \r\n    private documentService: DocumentService,\r\n   \r\n  ) {\r\n    console.log('Hello BlockStepsComponent Component');\r\n    this.text = 'Hello World';\r\n  }\r\n\r\n  route(page){\r\n    // try{\r\n    //   this.nav.pop();\r\n    // }\r\n    // catch(e) {\r\n    //   // nothing to pop\r\n    // };\r\n    $('.block-pdf-page').empty();\r\n    this.nav.push(page, {\r\n      guid: this.documentService.currentDoc.guid\r\n    });\r\n  }\r\n\r\n \r\n\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/block-steps/block-steps.ts","import { Directive, Input, ElementRef, Renderer, Output } from '@angular/core';\r\nimport { DomController } from 'ionic-angular';\r\ndeclare let dragOn: any;\r\ndeclare let interact: any;\r\ndeclare let $: any;\r\n\r\n/**\r\n * Generated class for the AbsoluteDragDirective directive.\r\n *\r\n * See https://angular.io/api/core/Directive for more info on Angular\r\n * Directives.\r\n */\r\n@Directive({\r\n  selector: '[absolute-drag]' // Attribute selector\r\n})\r\nexport class AbsoluteDragDirective {\r\n\r\n\r\n  @Input('startLeft') startLeft: any;\r\n  @Input('startTop') startTop: any;\r\n  public svgDrawer : any;\r\n\r\n  constructor(public element: ElementRef, public renderer: Renderer, public domCtrl: DomController) {\r\n  \r\n  }\r\n\r\n  ngAfterViewInit() {\r\n \r\n\r\n    this.initDragOn();\r\n\r\n    // this.renderer.setElementStyle(this.element.nativeElement, 'position', 'absolute');\r\n    // this.renderer.setElementStyle(this.element.nativeElement, 'left', this.startLeft + 'px');\r\n    // this.renderer.setElementStyle(this.element.nativeElement, 'top', this.startTop + 'px');\r\n\r\n    //let hammer = new window['Hammer'](this.element.nativeElement);\r\n    // hammer.get('pan').set({ direction: window['Hammer'].DIRECTION_ALL });\r\n\r\n    // hammer.on('pan', (ev) => {\r\n    //   this.handlePan(ev);\r\n     \r\n    // });\r\n\r\n}\r\n\r\nngOnDestroy(){\r\n  //this.svgDrawer.off();\r\n  //this.svgDrawer.remove();\r\n  //$(this.svgDrawer.elem).remove();\r\n  this.startLeft = null;\r\n  this.startTop = null;\r\n}\r\n\r\n// handlePan(ev){\r\n\r\n//     let newLeft = ev.center.x;\r\n//     let newTop = ev.center.y;\r\n\r\n//     this.domCtrl.write(() => {\r\n//         this.renderer.setElementStyle(this.element.nativeElement, 'left', newLeft + 'px');\r\n//         this.renderer.setElementStyle(this.element.nativeElement, 'top', newTop + 'px');\r\n//     });\r\n\r\n// }\r\n\r\ninitDragOn() {\r\n\r\n  try{\r\n    this.svgDrawer  = dragOn(document.querySelector(\".dropzone\"), {\r\n      listenTo: '.draggable'\r\n    });\r\n\r\n   \r\n  }\r\n  catch(e){}\r\n  \r\n\r\n\r\n  // target elements with the \"resizable\" class\r\n  // interact('.resizable')\r\n  //   .resizable({\r\n  //     // preserveAspectRatio: true,\r\n  //     edges: {\r\n  //       left: true,\r\n  //       right: true,\r\n  //       bottom: true,\r\n  //       top: true\r\n  //     }\r\n  //   })\r\n  //   .on('resizemove', (event) => {\r\n\r\n  //     svgDrawer.updateMetrics();\r\n\r\n  //     var target = event.target,\r\n  //       x = (parseFloat(target.getAttribute('data-x')) || 0),\r\n  //       y = (parseFloat(target.getAttribute('data-y')) || 0);\r\n\r\n  //     // update the element's style\r\n  //     target.style.width = event.rect.width + 'px';\r\n  //     target.style.height = event.rect.height + 'px';\r\n\r\n  //     // translate when resizing from top or left edges\r\n  //     x += event.deltaRect.left;\r\n  //     y += event.deltaRect.top;\r\n\r\n  //     target.style.webkitTransform = target.style.transform =\r\n  //       'translate(' + x + 'px,' + y + 'px)';\r\n\r\n  //     target.setAttribute('data-x', x);\r\n  //     target.setAttribute('data-y', y);\r\n  //   });\r\n\r\n\r\n\r\n\r\n\r\n}\r\n\r\n\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/directives/absolute-drag/absolute-drag.ts","import { Component, ChangeDetectionStrategy, ViewEncapsulation, ChangeDetectorRef } from '@angular/core';\r\nimport { IonicPage, NavController, NavParams } from 'ionic-angular';\r\nimport { DocumentService } from './../../services/document.service';\r\nimport { EmailService } from './../../services/email.service';\r\nimport { BlockStackService } from './../../services/blockstack.service';\r\nimport { Observable } from 'rxjs';\r\nimport { delay, map, tap, distinctUntilChanged, debounceTime, switchMap } from 'rxjs/operators';\r\nimport { of } from 'rxjs/observable/of';\r\nimport { Subject } from 'rxjs';\r\nimport { FormGroup, FormControl } from '@angular/forms';\r\nimport { LoadingController } from 'ionic-angular';\r\ndeclare let blockstack: any;\r\n\r\n/**\r\n * Generated class for the SignPage page.\r\n *\r\n * See https://ionicframework.com/docs/components/#navigation for more info on\r\n * Ionic pages and navigation.\r\n */\r\n\r\n@IonicPage({\r\n  name: 'EmailPage',\r\n  segment: 'email/:guid',\r\n  defaultHistory: ['AnnotatePage', 'HomePage'],\r\n})\r\n@Component({\r\n  selector: 'page-email',\r\n  templateUrl: 'email.html',\r\n  changeDetection: ChangeDetectionStrategy.Default,\r\n  encapsulation: ViewEncapsulation.None,\r\n})\r\nexport class EmailPage {\r\n\r\n  email = \"\";\r\n  lookupId: string;\r\n  user: string;\r\n  people3: any = [];\r\n  people3Loading = false;\r\n  selectedUser = [];\r\n  people3Typeahead = new Subject<string>();\r\n  loading;\r\n\r\n  constructor(\r\n    public navCtrl: NavController,\r\n    public navParams: NavParams,\r\n    public documentService: DocumentService,\r\n    public emailService: EmailService,\r\n    public blockStackService: BlockStackService,\r\n    public chg: ChangeDetectorRef,\r\n    public loadingCtrl: LoadingController\r\n  ) {\r\n\r\n    if (this.navParams.get(\"guid\") && !this.documentService.currentDoc) {\r\n      let guid = this.navParams.get(\"guid\");\r\n      this.documentService.getDocumentsIndex(true).then((data) => {\r\n        this.documentService.documentsList = data;\r\n        this.documentService.setCurrentDoc(guid);\r\n        //this.getFile();\r\n        // @todo in side menu highlight selected doc\r\n      });\r\n    }\r\n    else {\r\n      //this.getFile();\r\n    }\r\n\r\n  }\r\n\r\n  async ionViewDidLoad() {\r\n    console.log('ionViewDidLoad SignPage');\r\n    this.lookup();\r\n    this.loadPeople3();\r\n  }\r\n\r\n  next() {\r\n    this.navCtrl.push(\"SignPage\", {\r\n      guid: this.documentService.currentDoc.guid\r\n    });\r\n  }\r\n\r\n  back() {\r\n    this.navCtrl.push(\"AnnotatePage\", {\r\n      guid: this.documentService.currentDoc.guid\r\n    });\r\n  }\r\n\r\n  getUrl() {\r\n    return window.location.href;\r\n  }\r\n\r\n  lookup() {\r\n    blockstack.lookupProfile(\"blockusign1.id\")\r\n      .then((profile) => {\r\n        let data = profile;\r\n      })\r\n      .catch((error) => {\r\n        console.log('could not resolve profile')\r\n      })\r\n  }\r\n\r\n  async searchUser(user) {\r\n    let resp = await this.blockStackService.searchUser(user);\r\n  }\r\n\r\n  private loadPeople3() {\r\n    this.people3Typeahead.pipe(\r\n      tap( () => this.people3Loading = true),\r\n      distinctUntilChanged(),\r\n      debounceTime(375),\r\n      switchMap(term => \r\n        this.blockStackService.searchUser(term)\r\n      ),\r\n    ).subscribe(x => {\r\n      this.people3 = x;\r\n      this.people3Loading = false;\r\n      //this.chg.markForCheck();\r\n      console.log(\"ppl loading false\");\r\n    }, () => {\r\n      this.people3 = [];\r\n      console.log(\"[]\");\r\n    });\r\n  }\r\n\r\n  async sendEmail(e){\r\n    if (!this.email){\r\n      alert('Please enter an email address');\r\n      return;\r\n    }\r\n\r\n    this.loading = this.loadingCtrl.create({\r\n      content: 'Please wait...'\r\n    });\r\n    this.loading.present();\r\n\r\n    let documentLink = window.location.origin + \"/#/sign/\" + this.documentService.currentDoc.guid + \"/?docData=\" + btoa(JSON.stringify(this.documentService.currentDoc));\r\n    let subject = blockstack.loadUserData().profile.name + \" has sent you a document to sign - \" + this.documentService.currentDoc.fileName;\r\n    let content = \"Please click this link and sign the document. Thanks! <br/><br/><a href='\" + documentLink + \"' >document link</a>\";\r\n    await this.emailService.sendEmail(this.email, subject, content);\r\n\r\n    // add as signer\r\n    this.documentService.currentDoc.signer.push(this.email);    \r\n    await this.documentService.updateDocument(this.documentService.currentDoc.guid, this.documentService.currentDoc)\r\n\r\n    this.loading.dismiss();\r\n\r\n    alert('Email sent!');\r\n  }\r\n\r\n  clickedUser(){\r\n    // @todo spoofed\r\n    setTimeout( ()=>{\r\n      alert('Email not found. Please enter below');\r\n    }, 1000 );\r\n  }\r\n\r\n\r\n\r\n\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/email/email.ts","import { Injectable } from '@angular/core';\r\nimport { Document, Log, Message } from './../models/models';\r\nimport 'rxjs/add/operator/toPromise';\r\nimport { Http, Response } from '@angular/http';\r\nimport { Observable } from 'rxjs/Observable';\r\nimport 'rxjs/add/operator/map';\r\nimport 'rxjs/add/operator/catch';\r\nimport { AnonymousSubject } from 'rxjs/Subject';\r\nimport { Events } from 'ionic-angular';\r\nimport { map } from 'rxjs/operators';\r\nimport { of } from 'rxjs/observable/of';\r\nimport { delay } from 'rxjs/operator/delay';\r\nimport { Headers, RequestOptionsArgs, RequestOptions } from '@angular/http';\r\nimport { HttpHeaders } from '@angular/common/http';\r\ndeclare let blockstack: any;\r\n\r\n@Injectable()\r\nexport class BlockStackService {\r\n\r\n  public picCache = [];\r\n  public blockusignProfileUrl = \"blockusign.profile.json\";\r\n  public profile;\r\n  //url = \"https://blockusign.co/api/email\";\r\n  url = \"http://localhost:5000/api/profile\";\r\n  public userName;\r\n  public userId;\r\n  public profileName;\r\n \r\n  constructor(\r\n    public events: Events,\r\n    public http: Http\r\n  ) {\r\n   \r\n  }\r\n\r\n  async searchUser(user) {\r\n    // get from server\r\n    let resp = await this.http.get(\"https://core.blockstack.org/v1/search?query=\" + user).map(r => r.json().results).toPromise();\r\n    return resp;\r\n  }\r\n\r\n  async getPicUrl(userId) {\r\n\r\n    // placeholder\r\n    let picUrl = \"http://www.gravatar.com/avatar/?d=identicon\";\r\n    try {\r\n      if (!userId) {\r\n        return picUrl;\r\n      }\r\n\r\n      // get from cache\r\n      let isInCache = this.picCache.filter(item => item.id === userId)[0];\r\n      if (isInCache) {\r\n        return this.picCache.filter(item => item.id === userId)[0].pic;\r\n      }\r\n\r\n      // get from server\r\n      let resp = await this.http.get(\"https://core.blockstack.org/v1/search?query=\" + userId).toPromise();\r\n      let respObj = JSON.parse(resp.text());\r\n      if (respObj.results.length > 0) {\r\n        picUrl = respObj.results[0].profile.image[0].contentUrl\r\n      }\r\n      this.picCache.push({\r\n        id: userId,\r\n        pic: picUrl\r\n      });\r\n    }\r\n    catch (e) {\r\n      console.log('Unable to getpic url')\r\n\r\n    }\r\n\r\n    return picUrl;\r\n\r\n  }\r\n\r\n\r\n  async getProfileData() {\r\n  \r\n    // this.clearProfileData();\r\n  \r\n    let profileData = await blockstack.getFile(this.blockusignProfileUrl, { decrypt: false });\r\n\r\n    let myProfile = JSON.parse(profileData);\r\n    if (myProfile) {\r\n      this.profile = myProfile\r\n      this.userId = blockstack.loadUserData().username || '';\r\n      this.userName = blockstack.loadUserData().username || '';\r\n      this.profileName = blockstack.loadUserData().profile.name || '';\r\n    }\r\n\r\n    return profileData;\r\n  }\r\n\r\n  async setProfileData(email) {\r\n    \r\n    let storagePath = blockstack.loadUserData().profile.apps[window.location.origin];\r\n    let json = {\r\n      email: email,\r\n      storagePath: storagePath,\r\n      appPublicKey: await this.getAppPublicKey()\r\n    }\r\n    return await blockstack.putFile(this.blockusignProfileUrl, JSON.stringify(json), { encrypt: false });\r\n  }\r\n\r\n  async clearProfileData() {\r\n    \r\n    let json = {\r\n    \r\n    }\r\n    return await blockstack.putFile(this.blockusignProfileUrl, JSON.stringify(json), { encrypt: false });\r\n  }\r\n\r\n  async getAppPublicKey(){\r\n    var myPublicKey  = await blockstack.getPublicKeyFromPrivate(blockstack.loadUserData().appPrivateKey);\r\n    return myPublicKey;\r\n  }\r\n\r\n  async writeGlobalProfile(){\r\n    let httpOptions = new RequestOptions();\r\n    httpOptions.headers = new Headers(\r\n      {\r\n        'Content-Type': 'application/json'\r\n      }\r\n    );\r\n    return await this.http.post(\"url\", JSON.stringify(this.profile), httpOptions)\r\n  }\r\n\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/services/blockstack.service.ts","import { Component } from '@angular/core';\r\nimport { IonicPage, NavController, NavParams } from 'ionic-angular';\r\nimport { DocumentService } from './../../services/document.service';\r\n\r\n/**\r\n * Generated class for the SignPage page.\r\n *\r\n * See https://ionicframework.com/docs/components/#navigation for more info on\r\n * Ionic pages and navigation.\r\n */\r\n\r\n@IonicPage({\r\n  name: 'ReviewPage',\r\n  segment: 'review/:guid',\r\n  defaultHistory: ['SignPage', 'EmailPage','AnnotatePage', 'HomePage']\r\n})\r\n@Component({\r\n  selector: 'page-review',\r\n  templateUrl: 'review.html',\r\n})\r\nexport class ReviewPage {\r\n\r\n  constructor(public navCtrl: NavController, public navParams: NavParams, public documentService: DocumentService) {\r\n\r\n    if ( this.navParams.get(\"guid\") && !this.documentService.currentDoc ){\r\n      let guid = this.navParams.get(\"guid\");\r\n      this.documentService.getDocumentsIndex(true).then((data) => {\r\n        this.documentService.documentsList = data;\r\n        this.documentService.setCurrentDoc(guid);\r\n        //this.getFile();\r\n        // @todo in side menu highlight selected doc\r\n      });\r\n    }\r\n    else{\r\n      //this.getFile();\r\n    }\r\n\r\n  }\r\n\r\n  ionViewDidLoad() {\r\n    console.log('ionViewDidLoad SignPage');\r\n  }\r\n\r\n \r\n\r\n  back(){\r\n    this.navCtrl.push(\"SignPage\", {\r\n      guid: this.documentService.currentDoc.guid\r\n    });\r\n  }\r\n\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/review/review.ts","import { Component, ViewChild, OnDestroy, AfterViewInit } from '@angular/core';\r\nimport { IonicPage, NavController, NavParams } from 'ionic-angular';\r\nimport { DocumentService } from './../../services/document.service';\r\nimport { BlockPdfComponent } from '../../components/block-pdf/block-pdf';\r\nimport { BlockChatComponent } from '../../components/block-chat/block-chat';\r\ndeclare let blockstack: any;\r\ndeclare let getQueryParam: any;\r\ndeclare let jslinq: any;\r\n\r\n/**\r\n * Generated class for the SignPage page.\r\n *\r\n * See https://ionicframework.com/docs/components/#navigation for more info on\r\n * Ionic pages and navigation.\r\n */\r\n\r\n@IonicPage({\r\n  name: 'SignPage',\r\n  segment: 'sign/:guid',\r\n  defaultHistory: ['EmailPage', 'AnnotatePage', 'HomePage']\r\n})\r\n@Component({\r\n  selector: 'page-sign',\r\n  templateUrl: 'sign.html',\r\n})\r\nexport class SignPage {\r\n\r\n  name: string;\r\n  @ViewChild(\"blockChat\") blockChat: BlockChatComponent;\r\n  @ViewChild(\"blockPdf\") blockPdf: BlockPdfComponent;\r\n\r\n  constructor(\r\n    public navCtrl: NavController,\r\n    public navParams: NavParams,\r\n    public documentService: DocumentService\r\n  ) {\r\n\r\n  }\r\n\r\n  ionViewDidLoad() {\r\n    this.init();\r\n  }\r\n\r\n  async init() {\r\n    \r\n    // if you are a signer and the document is not in your document.index then add it!\r\n    // @todo think about allowing a document to get signed by an anonymous person if they got it via email with the documentKey\r\n\r\n    // test - http://localhost:8100/#/sign/a48b11c6-349b-697b-90f9-8356c29ccbf8/?docData=eyJndWlkIjoiYTQ4YjExYzYtMzQ5Yi02OTdiLTkwZjktODM1NmMyOWNjYmY4IiwiY3JlYXRlZEF0IjoxNTI3MTI3NTgxNDgyLCJ1cGRhdGVkQXQiOjE1MjcxMjc1ODE0ODIsImhhc0Fubm90YXRpb25zIjpmYWxzZSwic3RlcCI6IkFubm90YXRlIiwiaXNDb21wbGV0ZWQiOmZhbHNlLCJmaWxlTmFtZSI6Im5pY2sgMS5wZGYiLCJkb2N1bWVudEtleSI6IjVjYmY0NjVjLTU5ODktOTNlMy02OGUxLTdkNTE5NzEyYTZmNCIsInBhdGhBbm5vdGF0ZWREb2MiOiJodHRwczovL2dhaWEuYmxvY2tzdGFjay5vcmcvaHViLzE4a1Rza0JwVGgxbXpuc3lwdTFmaEoyN2R4YkMxU3dYRUsvIiwicGF0aHMiOlt7Im5hbWUiOiJuaWNrIHRlZSIsInVzZXJJZCI6Im5pY2t0ZWUuaWQiLCJwYXRoVG9TdG9yYWdlIjoiaHR0cHM6Ly9nYWlhLmJsb2Nrc3RhY2sub3JnL2h1Yi8xOGtUc2tCcFRoMW16bnN5cHUxZmhKMjdkeGJDMVN3WEVLLyJ9XSwic2lnbmVyIjpbImJsb2NrdXNpZ24uaWQiXX0=\r\n\r\n    let docData = getQueryParam('docData');\r\n   \r\n    // my doc\r\n    if (this.navParams.get(\"guid\") && !this.documentService.currentDoc && !docData) {\r\n      let guid = this.navParams.get(\"guid\");\r\n      this.documentService.getDocumentsIndex(true).then((data) => {\r\n        this.documentService.documentsList = data;\r\n        this.documentService.setCurrentDoc(guid);\r\n      });\r\n    }\r\n    // their doc\r\n    else if (this.navParams.get(\"guid\") && !this.documentService.currentDoc && docData) {\r\n      let jsonDoc = atob(docData);\r\n      let doc = JSON.parse(jsonDoc);\r\n      let resp = await this.documentService.getDocumentsIndex(true);\r\n      this.documentService.documentsList = resp;\r\n      let guid = this.navParams.get(\"guid\");\r\n   \r\n      if (this.documentService.documentExists(guid)) {\r\n        this.documentService.setCurrentDoc(guid);\r\n      }\r\n      else {\r\n        //get the file buffer\r\n        let path = doc.pathAnnotatedDoc + this.navParams.get(\"guid\") + \".pdf\";\r\n        console.log(path);\r\n\r\n        let fileBuffer = await this.documentService.getDocumentByPath(path, doc.documentKey);\r\n\r\n\r\n        \r\n        let copied = await this.documentService.copyDocument(doc, guid, fileBuffer);\r\n        \r\n        this.blockPdf.ngOnInit();\r\n      }\r\n    }\r\n    else{\r\n      console.log('Error, must pass in guid')\r\n    }\r\n\r\n    console.log('ionViewDidLoad SignPage');\r\n    this.name = blockstack.loadUserData().profile.name;\r\n\r\n\r\n    // setTimeout( () =>{\r\n    //   this.documentService.mergeAnnotations(this.navParams.get(\"guid\") );\r\n    // }, 3000 )\r\n   \r\n   \r\n\r\n  }\r\n\r\n  ionViewDidEnter(){\r\n    this.blockPdf.registerEmojiEvent();\r\n    this.blockChat.registerEmojiEvent();\r\n  }\r\n\r\n  ionViewWillLeave() {\r\n    this.blockChat.destroyEmojiEvents();\r\n    this.blockChat.firstLoad = true;\r\n    this.blockChat.ngOnDestroy();\r\n    this.blockPdf.destroyEmojiEvents();\r\n  }\r\n\r\n  next() {\r\n    this.navCtrl.push(\"ReviewPage\", {\r\n      guid: this.documentService.currentDoc.guid\r\n    });\r\n  }\r\n\r\n  back() {\r\n    this.navCtrl.push(\"EmailPage\", {\r\n      guid: this.documentService.currentDoc.guid\r\n    });\r\n  }\r\n\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/sign/sign.ts","import { Component, ViewChild } from '@angular/core';\r\nimport { Nav, Platform, Toast } from 'ionic-angular';\r\nimport { StatusBar } from '@ionic-native/status-bar';\r\nimport { SplashScreen } from '@ionic-native/splash-screen';\r\nimport { HomePage } from '../pages/home/home';\r\nimport { AnnotatePage } from '../pages/annotate/annotate';\r\nimport { DocumentService } from '../services/document.service';\r\nimport { PopoverController, ToastController} from 'ionic-angular';\r\nimport { ViewController } from 'ionic-angular';\r\nimport { OptionsPopoverPage } from './options.popover.page';\r\nimport { MenuController } from 'ionic-angular';\r\nimport { BlockStackService } from './../services/blockstack.service';\r\nimport moment from 'moment-timezone';\r\nimport 'rxjs/add/operator/toPromise';\r\nimport { LoadingController } from 'ionic-angular';\r\nimport { prototype } from 'long';\r\ndeclare let blockstack: any;\r\ndeclare let document: any;\r\ndeclare var window: any;\r\nconst $ = document.querySelectorAll.bind(document);\r\nimport { AlertController } from 'ionic-angular';\r\ndeclare let jQuery: any;\r\n\r\n\r\n\r\n@Component({\r\n  templateUrl: 'app.html'\r\n})\r\nexport class MyApp {\r\n  @ViewChild(Nav) nav: Nav;\r\n\r\n  rootPage: any = HomePage;\r\n\r\n  pages: Array<{ title: string, component: any }>;\r\n\r\n  name: string;\r\n  isLoggedIn = false;\r\n  loginState = \"Login\";\r\n  fileName = \"blockusign/pdf1.pdf\";\r\n  profile: any;\r\n  pdfBuffer: any;\r\n  avatar: string = \"http://www.gravatar.com/avatar/?d=identicon\";\r\n  documentsList: any;\r\n  email: string;\r\n\r\n  constructor(\r\n    public platform: Platform,\r\n    public statusBar: StatusBar,\r\n    public splashScreen: SplashScreen,\r\n    public loadingCtrl: LoadingController,\r\n    private alertCtrl: AlertController,\r\n    public documentService: DocumentService,\r\n    public popoverCtrl: PopoverController,\r\n    public menuCtrl: MenuController,\r\n    public blockStackService: BlockStackService,\r\n    public toastCntrl: ToastController\r\n  ) {\r\n\r\n    this.initializeApp();\r\n\r\n    // used for an example of ngFor and navigation\r\n    this.pages = [\r\n      { title: '1). Upload PDF', component: HomePage },\r\n      { title: '2). Annotate PDF', component: AnnotatePage }\r\n    ];\r\n\r\n    // global vars\r\n    if (window.location.host.includes(\"localhost\")) {\r\n      window.apiUrl = \"http://localhost:5000\";\r\n    }\r\n    else {\r\n      window.apiUrl = \"\";\r\n    }\r\n\r\n\r\n  }\r\n\r\n  initializeApp() {\r\n    this.platform.ready().then(() => {\r\n      // Okay, so the platform is ready and our plugins are available.\r\n      // Here you can do any higher level native things you might need.\r\n\r\n\r\n      this.statusBar.styleDefault();\r\n      this.splashScreen.hide();\r\n      this.showProfile();\r\n      this.setupDiscordMenu();\r\n\r\n\r\n    });\r\n  }\r\n\r\n  // openPage(page) {\r\n  //   // Reset the content nav to have just this page\r\n  //   // we wouldn't want the back button to show in this scenario\r\n  //   this.nav.setRoot(page.component);\r\n  // }\r\n\r\n  login() {\r\n    const origin = window.location.origin\r\n    blockstack.redirectToSignIn(origin, origin + '/manifest.json', ['store_write', 'publish_data', 'email'])\r\n  }\r\n\r\n  next() {\r\n\r\n\r\n    this.menuCtrl.close();\r\n\r\n    // if (this.nav.getActive().name == \"AnnotatePage\") {\r\n    //  this.nav.pop();\r\n    // }\r\n    // else{\r\n    //   jQuery('.block-pdf-page').empty();\r\n    // }\r\n\r\n    this.nav.setRoot(\"HomePage\");\r\n\r\n    let guid = this.documentService.currentDoc.guid;\r\n    this.nav.push(\"AnnotatePage\", {\r\n      guid: guid\r\n    });\r\n\r\n  }\r\n\r\n  home() {\r\n    this.menuCtrl.close();\r\n    this.nav.setRoot(\"HomePage\");\r\n    this.clearActive();\r\n  }\r\n\r\n  logout() {\r\n    blockstack.signUserOut(window.location.origin);\r\n  }\r\n\r\n  async showProfile() {\r\n\r\n    if (blockstack.isUserSignedIn()) {\r\n\r\n      let profile = blockstack.loadUserData();\r\n      this.name = profile.username;\r\n      this.isLoggedIn = true;\r\n      try {\r\n        this.avatar = profile.profile.image[0].contentUrl;\r\n      } catch (e) { console.log('no profile pic') }\r\n\r\n      this.loginState = \"[Logout]\";\r\n      this.documentService.getDocumentsIndex(true).then((data) => {\r\n        this.documentsList = this.documentService.documentsListFiltered; //data;\r\n      });\r\n\r\n      //if (!profile.username) {\r\n\r\n        let profileData = await this.blockStackService.getProfileData();\r\n\r\n        if (!profileData) {\r\n          this.profileModal(this.email);\r\n        }\r\n        else {\r\n          let myProfile = JSON.parse(profileData);\r\n          if (!myProfile.email){\r\n            this.profileModal(this.email);\r\n          }\r\n          else {\r\n            this.name = myProfile.email;\r\n          }\r\n        }\r\n\r\n      //}\r\n\r\n    } else if (blockstack.isSignInPending()) {\r\n      blockstack.handlePendingSignIn().then(function (userData) {\r\n        window.location = window.location.origin\r\n        this.documentsGetList();\r\n      });\r\n    }\r\n    else {\r\n      if (localStorage.getItem('signUp') !== 'true') {\r\n        window.location.href = \"signup.html\";\r\n      }\r\n      else {\r\n        localStorage.setItem('signUp', 'true');\r\n        this.login();\r\n      }\r\n\r\n    }\r\n  }\r\n\r\n  public setupDiscordMenu() {\r\n    $(\".focusable, .button\").forEach(el => {\r\n      // blur only on mouse click\r\n      // for accessibility, keep focus when keyboard focused\r\n      el.addEventListener(\"mousedown\", e => e.preventDefault());\r\n      el.setAttribute(\"tabindex\", \"0\");\r\n    });\r\n\r\n    $(\".server\").forEach(el => {\r\n      el.addEventListener(\"click\", () => {\r\n        const activeServer = $(\".server.active\")[0];\r\n        activeServer.classList.remove(\"active\");\r\n        activeServer.removeAttribute(\"aria-selected\");\r\n\r\n        el.classList.add(\"active\");\r\n        el.setAttribute(\"aria-selected\", true);\r\n      });\r\n    })\r\n\r\n    $(\".channel-text\").forEach(el => {\r\n      el.addEventListener(\"click\", () => {\r\n        $(\".channel-text.active\")[0].classList.remove(\"active\");\r\n        el.classList.add(\"active\");\r\n      });\r\n    })\r\n\r\n    // focus/blur on channel header click\r\n    $(\".channels-header\")[0].addEventListener(\"click\", e => {\r\n      e.preventDefault();\r\n\r\n      const focused = document.activeElement === e.target;\r\n      focused ? e.target.blur() : e.target.focus();\r\n    });\r\n  }\r\n\r\n  documentSelected(e, selectedDocument) {\r\n\r\n    this.documentService.currentDoc = selectedDocument;\r\n    this.next();\r\n  }\r\n\r\n\r\n\r\n\r\n  documentsGetList() {\r\n    this.documentService.getDocumentsIndex(true).then((data) => {\r\n      this.documentsList = this.documentService.documentsListFiltered; //data;\r\n    });\r\n  }\r\n\r\n\r\n  presentPopover(myEvent, item) {\r\n    let popover = this.popoverCtrl.create(OptionsPopoverPage, { selectedDoc: item });\r\n    popover.present({\r\n      ev: myEvent,\r\n\r\n    });\r\n  }\r\n\r\n  clearActive() {\r\n\r\n    $(\".channel-text\").forEach(el => {\r\n      try {\r\n        $(\".channel-text.active\")[0].classList.remove(\"active\");\r\n      }\r\n      catch (e) { }\r\n    });\r\n  }\r\n\r\n  profileModal(email) {\r\n\r\n    let alert = this.alertCtrl.create({\r\n      title: 'Please enter your email',\r\n      enableBackdropDismiss: false,\r\n      inputs: [\r\n        {\r\n          name: 'email',\r\n          placeholder: 'email',\r\n          value: email\r\n        }\r\n      ],\r\n      buttons: [\r\n        // {\r\n        //   text: 'Cancel',\r\n        //   role: 'cancel',\r\n        //   handler: data => {\r\n        //     console.log('Cancel clicked');\r\n        //   }\r\n        // },\r\n        {\r\n          text: 'Ok',\r\n          handler: data => {\r\n\r\n            // save here\r\n\r\n            this.blockStackService.setProfileData(data.email);\r\n\r\n            if (data.email.indexOf(\"@\") != -1) {\r\n              // logged in!\r\n            } else {\r\n              // invalid login\r\n              this.showErrorToast('Invalid Email');\r\n              return false;\r\n            }\r\n          }\r\n        }\r\n      ]\r\n    });\r\n    alert.present();\r\n  }\r\n\r\n  showErrorToast(data: any) {\r\n    let toast = this.toastCntrl.create({\r\n      message: data,\r\n      duration: 3000,\r\n      position: 'top'\r\n    });\r\n\r\n    toast.onDidDismiss(() => {\r\n      console.log('Dismissed toast');\r\n    });\r\n\r\n    toast.present();\r\n  }\r\n\r\n\r\n  filterDocumentList(signer, e){\r\n    this.documentService.filterDocuments(signer);\r\n    this.documentsList = this.documentService.documentsListFiltered;\r\n   \r\n\r\n    const activeServer = $(\".server.active\")[0];\r\n    activeServer.classList.remove(\"active\");\r\n    activeServer.removeAttribute(\"aria-selected\");\r\n\r\n    e.currentTarget.classList.add(\"active\");\r\n    e.currentTarget.setAttribute(\"aria-selected\", true);\r\n    \r\n  }\r\n\r\n  copyBtc(){\r\n    let el = document.getElementById('btc');\r\n\r\n    el.select();\r\n    document.execCommand(\"copy\");\r\n\r\n    let toast = this.toastCntrl.create({\r\n      message: 'BTC Address copied ' + el.value,\r\n      duration: 2000,\r\n      position: 'middle'\r\n    });\r\n  \r\n    toast.onDidDismiss(() => {\r\n      console.log('Dismissed toast');\r\n    });\r\n  \r\n    toast.present();\r\n  }\r\n\r\n}\r\n\r\n\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/app.component.ts","import { Injectable } from '@angular/core';\r\nimport { Http, Response } from '@angular/http';\r\nimport { Observable } from 'rxjs/Observable';\r\nimport 'rxjs/add/operator/map';\r\nimport 'rxjs/add/operator/catch';\r\n\r\n@Injectable()\r\nexport class CoinService {\r\n    \r\n    baseUrl = \"https://min-api.cryptocompare.com/data/histohour?fsym=\";\r\n\r\n    coin = \"IOT\";\r\n\r\n    symbol = \"IOT\";\r\n\r\n    params = \"&tsym=USD&limit=60&aggregate=3&e=CCCAGG\";\r\n    \r\n    public url = \"\";\r\n\r\n    constructor(private http: Http) { \r\n\r\n    }\r\n\r\n   async getCoin(coin){\r\n\r\n        this.coin = coin;\r\n    \r\n        this.url = this.baseUrl + this.coin + this.params;\r\n        let response = await this.http.get(this.url).toPromise();\r\n\r\n        return response;\r\n    }\r\n\r\n    async getAllCoins(){\r\n        let resp = await this.http.get(\"https://min-api.cryptocompare.com/data/all/coinlist\").toPromise();\r\n        return resp;\r\n    }\r\n    \r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/services/coin.service.ts","import { Injectable } from '@angular/core';\r\nimport { Http, Response, Jsonp } from '@angular/http';\r\nimport { Observable } from 'rxjs/Observable';\r\nimport 'rxjs/add/operator/map';\r\nimport 'rxjs/add/operator/catch';\r\ndeclare var $: any;\r\ndeclare var window: any;\r\n\r\n@Injectable()\r\nexport class CryptoCompareService {\r\n\r\n    baseUrl = \"https://www.cryptocompare.com/api/data\";\r\n\r\n    apiUrl = window.apiUrl ; //http://localhost:5000 http://popbot2.azurewebsites.net\r\n\r\n    url;\r\n\r\n    currency = \"BTC\";\r\n\r\n    aggregate = \"1\";\r\n\r\n    constructor(private http: Http, private jsonp: Jsonp) {\r\n\r\n    }\r\n\r\n    public async getTopCoins() {\r\n\r\n        let url = \"https://api.coinmarketcap.com/v1/ticker/?limit=377\";\r\n        let response = await this.http.get(url).toPromise();\r\n\r\n        let coinRefResponse = await this.http.get(\"https://min-api.cryptocompare.com/data/all/coinlist\").toPromise();\r\n        let coinsRef = coinRefResponse.json().Data;\r\n\r\n        let topCoins = {};\r\n        response.json().forEach(element => {\r\n            let coinData = coinsRef[element.symbol];\r\n            if (coinData) {\r\n                coinData.rank = element.rank;\r\n                topCoins[element.symbol] = coinData;\r\n            }\r\n            else {\r\n                console.error(\"Cannot find \" + element.symbol);\r\n            }\r\n        });\r\n\r\n\r\n\r\n        return topCoins;\r\n    }\r\n\r\n    public async getSocialStats(coinId, limit) {\r\n\r\n        if (!coinId)\r\n            coinId = 306304;\r\n\r\n        if (!limit)\r\n            limit = 337;\r\n\r\n        let api = \"/socialstatshistohour/?aggregate=1&id=\" + coinId + \"&limit=\" + limit;\r\n\r\n\r\n        this.url = this.baseUrl + api;\r\n        let response = await this.http.get(this.url).toPromise();\r\n\r\n        return response;\r\n    }\r\n\r\n\r\n    async getCoins(coinLimit, histPriceLimit, socialLimit, currency, aggregate ) {\r\n\r\n        this.currency = currency;\r\n        this.aggregate = aggregate;\r\n\r\n        if (!coinLimit) coinLimit = 10;\r\n\r\n        if (!histPriceLimit) histPriceLimit = 24;\r\n\r\n        if (!socialLimit) socialLimit = 24;\r\n\r\n\r\n        return await this.http.get(this.apiUrl + \"/api/coins?coinLimit=\" + coinLimit + \"&histPriceLimit=\"+ histPriceLimit + \"&socialLimit=\" + socialLimit + \"&currency=\" + this.currency + \"&aggregate=\" +  this.aggregate).toPromise();\r\n       \r\n    }\r\n\r\n\r\n\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/services/cryptocompare.service.ts","import { Injectable } from '@angular/core';\r\nimport { Http, Response, Jsonp, RequestOptions, RequestOptionsArgs, Headers } from '@angular/http';\r\nimport { Observable } from 'rxjs/Observable';\r\nimport 'rxjs/add/operator/map';\r\nimport 'rxjs/add/operator/catch';\r\ndeclare var $: any;\r\ndeclare var window: any;\r\n\r\n@Injectable()\r\nexport class SlackService {\r\n\r\n    baseUrl = window.apiUrl + \"/api/slack\"; //\"https://hooks.slack.com/services/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\";\r\n\r\n\r\n    constructor(private http: Http, private jsonp: Jsonp) {\r\n\r\n    }\r\n\r\n\r\n    async sendAlert( msg ) {\r\n        return await this.http.get(this.baseUrl + \"/\" + msg).toPromise();\r\n    }\r\n\r\n\r\n\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/services/slack.service.ts"],"sourceRoot":""}